#define m1                     1  

#define m5                     2  
#define m5_m1                  3
#define m15                    4  
#define m15_m1                 5
#define m15_m5                 6
#define m15_m5_m1              7

#define m30                    8 
#define m30_m1                 9 
#define m30_m5                 10 
#define m30_m5_m1              11 
#define m30_m15                12 
#define m30_m15_m1             13 
#define m30_m15_m5             14 
#define m30_m15_m5_m1          15                   

#define h1                     16 
#define h1_m1                  17 
#define h1_m5                  18 
#define h1_m5_m1               19 
#define h1_m15                 20 
#define h1_m15_m1              21 
#define h1_m15_m5              22 
#define h1_m15_m5_m1           23 
#define h1_m30                 24 
#define h1_m30_m1              25 
#define h1_m30_m5              26 
#define h1_m30_m5_m1           27 
#define h1_m30_m15             28 
#define h1_m30_m15_m1          29
#define h1_m30_m15_m5          30 
#define h1_m30_m15_m5_m1       31

#define h4                     32   // H4 
#define h4_m1                  33   // H4 M1
#define h4_m5                  34   // H4 M5
#define h4_m5_m1               35   // H4 M5 M1
#define h4_m15                 36   // H4 M15
#define h4_m15_m1              37   // H4 M15 M1
#define h4_m15_m5              38   // H4 M15 M5
#define h4_m15_m5_m1           39   // H4 M15 M5 M1
#define h4_m30                 40   // H4 M30
#define h4_m30_m1              41   // H4 M30
#define h4_m30_m5              42   // H4 M30 M5 
#define h4_m30_m5_m1           43   // H4 M30 M5 M1
#define h4_m30_m15             44   // H4 M30 M15 
#define h4_m30_m15_m1          45   // H4 M30 M15 M1
#define h4_m30_m15_m5          46   // H4 M30 M15 M5
#define h4_m30_m15_m5_m1       47   // H4 M30 M15 M5 M1
#define h4_h1                  48   // H4 H1 
#define h4_h1_m1               49   // H4 H1 M1
#define h4_h1_m5               50   // H4 H1 M5
#define h4_h1_m15              52   // H4 H1 M15
#define h4_h1_m15_m5           54   // H4 H1 M15 M5
#define h4_h1_m15_m5_m1        55   // H4 H1 M15 M5 M1
#define h4_h1_m30              56   // H4 H1 M30
#define h4_h1_m30_m1           57   // H4 H1 M30 M1
#define h4_h1_m30_m5           58   // H4 H1 M30 M5
#define h4_h1_m30_m5_m1        59   // H4 H1 M30 M5 M1
#define h4_h1_m30_m15          60   // H4 H1 M30 M15
#define h4_h1_m30_m15_m1       61   // H4 H1 M30 M1
#define h4_h1_m30_m15_m5       62   // H4 H1 M30 M15 M5
#define h4_h1_m30_m15_m5_m1    63   // H4 H1 M30 M15 M5 M1

#define d1                     64 
#define d1_m1                  65
#define d1_m5                  66
#define d1_m5_m1               67
#define d1_m15                 68   // D1 M15
#define d1_m15_m1              69   // D1 M15 M1
#define d1_m15_m5              70   // D1 M15 M5
#define d1_m15_m5_m1           71   // D1 M15 M5 M1
#define d1_m30                 72   // D1 M30   
#define d1_m30_m1              73
#define d1_m30_m5              74
#define d1_m30_m5_m1           75          
#define d1_m30_m15             76   // D1 M30 M15    
#define d1_m30_m15_m1          77        
#define d1_m30_m15_m5          78   // D1 M30 M15 M5            
#define d1_m30_m15_m5_m1       79   // D1 M30 M15 M5 M1            
#define d1_h1                  80   // D1 H1
#define d1_h1_m1               81
#define d1_h1_m5               82
#define d1_h1_m5_m1            83
#define d1_h1_m15              84
#define d1_h1_m15_m1           85
#define d1_h1_m15_m5           86
#define d1_h1_m15_m5_m1        87
#define d1_h1_m30              88   // D1 H1 M30
#define d1_h1_m30_m1           89
#define d1_h1_m30_m5           90
#define d1_h1_m30_m5_m1        91
#define d1_h1_m30_m15          92   // D1 H1 M30 M15
#define d1_h1_m30_m15_m1       93
#define d1_h1_m30_m15_m5       94   // D1 H1 M30 M15 M5
#define d1_h1_m30_m15_m5_m1    95   // D1 H1 M30 M15 M5 M1   
#define d1_h4                  96   // D1 H4
#define d1_h4_m1               97
#define d1_h4_m5               98
#define d1_h4_m5_m1            99
#define d1_h4_m15              100
#define d1_h4_m15_m1           101
#define d1_h4_m15_m5           102
#define d1_h4_m15_m5_m1        103
#define d1_h4_m30              104
#define d1_h4_m30_m1           105
#define d1_h4_m30_m5           106
#define d1_h4_m30_m5_m1        107
#define d1_h4_m30_m15          108
#define d1_h4_m30_m15_m1       109
#define d1_h4_m30_m15_m5       110
#define d1_h4_m30_m15_m5_m1    111
#define d1_h4_h1               112   // D1 H4 H1 
#define d1_h4_h1_m1            113     
#define d1_h4_h1_m5            114     
#define d1_h4_h1_m5_m1         115     
#define d1_h4_h1_m15           116     
#define d1_h4_h1_m15_m1        117     
#define d1_h4_h1_m15_m5        118     
#define d1_h4_h1_m15_m5_m1     119     
#define d1_h4_h1_m30           120   //D1 H4 H1 M30
#define d1_h4_h1_m30_m1        121
#define d1_h4_h1_m30_m5        122     
#define d1_h4_h1_m30_m5_m1     123     
#define d1_h4_h1_m30_m15       124   //D1 H4 H1 M30 M15
#define d1_h4_h1_m30_m15_m1    125
#define d1_h4_h1_m30_m15_m5    126   //D1 H4 H1 M30 M15 M5
#define d1_h4_h1_m30_m15_m5_m1 127
#define w1                     128
#define w1_m1                  129
#define w1_m5                  130
#define w1_m5_m1               131
#define w1_m15                 132
#define w1_m15_m1              133
#define w1_m15_m5              134
#define w1_m15_m5_m1           135
#define w1_m30                 136
#define w1_m30_m1              137
#define w1_m30_m5              138
#define w1_m30_m5_m1           139      
#define w1_m30_m15             140
#define w1_m30_m15_m1          141 
#define w1_m30_m15_m5          142       
#define w1_m30_m15_m5_m1       143      
#define w1_h1                  144
#define w1_h1_m1               145
#define w1_h1_m5               146
#define w1_h1_m5_m1            147
#define w1_h1_m15              148
#define w1_h1_m15_m1           149
#define w1_h1_m15_m5           150
#define w1_h1_m15_m5_m1        151
#define w1_h1_m30              152
#define w1_h1_m30_m1           153
#define w1_h1_m30_m5           154
#define w1_h1_m30_m5_m1        155
#define w1_h1_m30_m15          156
#define w1_h1_m30_m15_m1       157
#define w1_h1_m30_m15_m5       158
#define w1_h1_m30_m15_m5_m1    159
#define w1_h4                  160
#define w1_h4_m1               161
#define w1_h4_m5               162
#define w1_h4_m5_m1            163
#define w1_h4_m15              164
#define w1_h4_m15_m1           165
#define w1_h4_m15_m5           166
#define w1_h4_m15_m5_m1        167
#define w1_h4_m30              168
#define w1_h4_m30_m1           169
#define w1_h4_m30_m5           170
#define w1_h4_m30_m5_m1        171
#define w1_h4_m30_m15          172
#define w1_h4_m30_m15_m1       173
#define w1_h4_m30_m15_m5       174
#define w1_h4_m30_m15_m5_m1    175
#define w1_h4_h1               176
#define w1_h4_h1_m1            177
#define w1_h4_h1_m5            178
#define w1_h4_h1_m5_m1         179
#define w1_h4_h1_m15           180
#define w1_h4_h1_m15_m1        181
#define w1_h4_h1_m15_m5        182
#define w1_h4_h1_m15_m5_m1     183
#define w1_h4_h1_m30           184
#define w1_h4_h1_m30_m1        185
#define w1_h4_h1_m30_m5        186
#define w1_h4_h1_m30_m5_m1     187
#define w1_h4_h1_m30_m15       188
#define w1_h4_h1_m30_m15_m1    189
#define w1_h4_h1_m30_m15_m5    190
#define w1_h4_h1_m30_m15_m5_m1 191
#define w1_d1                  192
#define w1_d1_m1               193  
#define w1_d1_m5                  194
#define w1_d1_m5_m1               195
#define w1_d1_m15                 196
#define w1_d1_m15_m1              197
#define w1_d1_m15_m5              198
#define w1_d1_m15_m5_m1           199
#define w1_d1_m30                 200
#define w1_d1_m30_m1              201
#define w1_d1_m30_m5              202
#define w1_d1_m30_m5_m1           203     
#define w1_d1_m30_m15             204
#define w1_d1_m30_m15_m1          205
#define w1_d1_m30_m15_m5          206  
#define w1_d1_m30_m15_m5_m1       207
#define w1_d1_h1                  208
#define w1_d1_h1_m1               209
#define w1_d1_h1_m5               210
#define w1_d1_h1_m5_m1            211
#define w1_d1_h1_m15              212
#define w1_d1_h1_m15_m1           213
#define w1_d1_h1_m15_m5           214
#define w1_d1_h1_m15_m5_m1        215
#define w1_d1_h1_m30              216
#define w1_d1_h1_m30_m1           217
#define w1_d1_h1_m30_m5           218
#define w1_d1_h1_m30_m5_m1        219
#define w1_d1_h1_m30_m15          220
#define w1_d1_h1_m30_m15_m1       221
#define w1_d1_h1_m30_m15_m5       222
#define w1_d1_h1_m30_m15_m5_m1    223
#define w1_d1_h4                  224
#define w1_d1_h4_m1               225
#define w1_d1_h4_m5               226
#define w1_d1_h4_m5_m1            227
#define w1_d1_h4_m15              228
#define w1_d1_h4_m15_m1           229
#define w1_d1_h4_m15_m5           230
#define w1_d1_h4_m15_m5_m1        231
#define w1_d1_h4_m30              232
#define w1_d1_h4_m30_m1           233
#define w1_d1_h4_m30_m5           234
#define w1_d1_h4_m30_m5_m1        235
#define w1_d1_h4_m30_m15          236
#define w1_d1_h4_m30_m15_m1       237
#define w1_d1_h4_m30_m15_m5       238
#define w1_d1_h4_m30_m15_m5_m1    239
#define w1_d1_h4_h1               240
#define w1_d1_h4_h1_m1            241
#define w1_d1_h4_h1_m5            242
#define w1_d1_h4_h1_m5_m1         243
#define w1_d1_h4_h1_m15           244
#define w1_d1_h4_h1_m15_m1        245
#define w1_d1_h4_h1_m15_m5        246
#define w1_d1_h4_h1_m15_m5_m1     247
#define w1_d1_h4_h1_m30           248
#define w1_d1_h4_h1_m30_m1        249
#define w1_d1_h4_h1_m30_m5        250
#define w1_d1_h4_h1_m30_m5_m1     251
#define w1_d1_h4_h1_m30_m15       252
#define w1_d1_h4_h1_m30_m15_m1    253
#define w1_d1_h4_h1_m30_m15_m5    254
#define w1_d1_h4_h1_m30_m15_m5_m1 255
#define mn1                       256 

//=============================================ORIENTATION==========================================

string       OrientationName[]      = {"LTERM","MTERM", "STERM"};
string       OrientationTypeName[]  = {"UP", "DOWN", "SIDEWAY", "SHARP", "NORMAL", "REVERSING", "OVERBOUGTH", "OVERSOLD"};


#define      NBR_ORIENTATIONS     3
#define      NBR_TYPEORIENTATIONS 8      
 
#define      LTERM                0
#define      MTERM                1
#define      STERM                2


#define      ORT_UP               0
#define      ORT_DOWN             1
#define      ORT_SIDEWAY          2
#define      ORT_SHARP            3
#define      ORT_NORMAL           4

#define      ORT_REVERSING        5
#define      ORT_OVERBOUGHT       6
#define      ORT_OVERSOLD         7



int          Orientation      = -1;
int          SharpOrientation = -1;

bool         OrientationConfirmed      = true;
bool         SharpOrientationConfirmed = true;

int          LastOrientation      = -1;
int          LastSharpOrientation = -1;


datetime     TimeOrientation;
datetime     TimeSharpOrientation;

// 1 day orientation
// 

int          LTermOrientation;
int          LTermTOrientation;
int          LTermLastOrientation;
datetime     LTermTimeOrientation;


int          MTermOrientation;
int          MTermTOrientation;
int          MTermLastOrientation;
datetime     MTermTimeOrientation;

int          STermOrientation;
int          STermTOrientation;
int          STermLastOrientation;
datetime     STermTimeOrientation;


int          LTermAction           = -1;
int          LTermLastAction;
datetime     LTermTimeAction;
double       LTermPriceAction;

int          MTermAction           = -1;
int          MTermLastAction;
datetime     MTermTimeAction;
double       MTermPriceAction;


int          STermAction           = -1;
int          STermLastAction;
datetime     STermTimeAction;
double       STermPriceAction;

int          LTerm_Nbr;
int          MTerm_Nbr;
int          STerm_Nbr;

bool         res_above_d1;
bool         sup_below_d1;      
bool         res_changed_d1;
bool         sup_changed_d1;      
bool         res_alert_d1;
bool         sup_alert_d1;      

bool         upfractal_alert_d1;
bool         downfractal_alert_d1;      
bool         upfractal_changed_d1;
bool         downfractal_changed_d1;
bool         upfractal_above_d1;
bool         downfractal_below_d1;

bool         ftrix_above_d1;
bool         ftrix_below_d1;

bool         ftrix_up_d1;
bool         ftrix_down_d1;
bool         ftrix_cross_up_d1;
bool         ftrix_cross_down_d1;
bool         ftrix_exitbuy_d1;
bool         ftrix_exitsell_d1;

bool         slope_up_d1;
bool         slope_down_d1;   
bool         slope_above_d1;
bool         slope_below_d1;
double       slope_angle_d1;      

bool         ma_7_up_d1; 
bool         ma_7_down_d1;
bool         ma_7_above_d1;
bool         ma_7_below_d1;
double       ma_7_angle_d1;      

// MTerm 

int          res_above;
int          sup_below;
int          upfractal_above;
int          downfractal_below;

int          upfractal_changed;
int          downfractal_changed;
int          upfractal_alert;
int          downfractal_alert;      

int          res_changed;
int          sup_changed;

int          ftrix_above;
int          ftrix_below;
int          ftrix_up;
int          ftrix_down;
int          ftrix_cross_up;
int          ftrix_cross_down;
int          ftrix_exitbuy;
int          ftrix_exitsell;

int          strix_up;
int          strix_down;
int          strix_above;
int          strix_below;

int          slope_above;
int          slope_below;
int          slope_up;
int          slope_down;
int          coral_above;
int          coral_below;
int          coral_up;
int          coral_down;
int          coral_cross_up;
int          coral_cross_down;

int          ichi_above;
int          ichi_below;
int          ichi_touched;


double       ma_200_angle_m30;
double       ma_200_current_m30;


double       slope_angle_m30;
double       slope_current_m30;


bool         ma_7_up_m30; 
bool         ma_7_down_m30;
bool         ma_7_above_m30;
bool         ma_7_below_m30;
double       ma_7_angle_m30;      
double       ma_7_current_m30;

double       divergence_m30;

// MTerm End

//STerm   m15 m5 m1


int          res_above_s;
int          sup_below_s;
int          upfractal_above_s;
int          downfractal_below_s;

int          upfractal_changed_s;
int          downfractal_changed_s;

int          res_changed_s;
int          sup_changed_s;


int          ftrix_above_s;
int          ftrix_below_s;
int          ftrix_up_s;
int          ftrix_down_s;
int          ftrix_cross_up_s;
int          ftrix_cross_down_s;
int          ftrix_exitbuy_s;
int          ftrix_exitsell_s;
int          strix_up_s;
int          strix_down_s;
int          strix_above_s;
int          strix_below_s;



int          slope_above_s;
int          slope_below_s;
int          slope_up_s;
int          slope_down_s;
int          slope_cross_up_s;
int          slope_cross_down_s;

int          coral_above_s;
int          coral_below_s;
int          coral_up_s;
int          coral_down_s;
int          coral_cross_up_s;
int          coral_cross_down_s;

int          ichi_above_s;
int          ichi_below_s;
int          ichi_cross_up_s;
int          ichi_cross_down_s;
int          ichi_touched_s;



double       ma_200_angle_m5;
double       ma_200_angle_m1;
double       ma_200_angle_m5_prev;

double       divergence_m5;

double       slope_angle_m5;
double       slope_angle_m5_prev;

double       slope_current_m5;
double       ma_200_current_m5;

double       volume_100_up;
double       volume_100_up_prev;
double       volume_100_down;
double       volume_100_down_prev;

double       velocity_m5;
double       velocity_m5_prev;

/*

bool GetSystemOrientation()
{
   int i = 0;
   int j = 0;
   int k = 0;
   int p;
   
// D1 L_Term
   upfractal_alert_d1          =  AndS (UPFRACTAL,   S_ALERT, P_D1);
   downfractal_alert_d1        =  AndS (DOWNFRACTAL, S_ALERT, P_D1);      
   upfractal_above_d1          =  AndS (UPFRACTAL,   S_ABOVE, P_D1);
   downfractal_below_d1        =  AndS (DOWNFRACTAL, S_BELOW, P_D1);      
   upfractal_changed_d1        =  AndS (UPFRACTAL, S_CHANGED, P_D1);
   downfractal_changed_d1      =  AndS (DOWNFRACTAL, S_CHANGED, P_D1);

   res_above_d1                =  AndS (RESISTANCE,  S_ABOVE, P_D1);
   sup_below_d1                =  AndS (SUPPORT,     S_BELOW, P_D1);      
   res_alert_d1                =  AndS (RESISTANCE,  S_ALERT, P_D1);
   sup_alert_d1                =  AndS (SUPPORT,     S_ALERT, P_D1);      
   res_changed_d1              =  AndS (RESISTANCE,  S_CHANGED, P_D1);
   sup_changed_d1              =  AndS (SUPPORT,     S_CHANGED, P_D1);      

   ftrix_above_d1              =  AndS (FTRIX, S_ABOVE,    P_D1);
   ftrix_below_d1              =  AndS (FTRIX, S_ABOVE,    P_D1);

   ftrix_up_d1                 =  AndS (FTRIX, S_UP,    P_D1);
   ftrix_down_d1               =  AndS (FTRIX, S_DOWN,  P_D1);
   ftrix_cross_up_d1           =  AndS (FTRIX, S_CROSS_UP,    P_D1);
   ftrix_cross_down_d1         =  AndS (FTRIX, S_CROSS_DOWN,  P_D1);
   ftrix_exitbuy_d1            =  AndS (FTRIX, S_EXIT_BUY,    P_D1);
   ftrix_exitsell_d1           =  AndS (FTRIX, S_EXIT_SELL,  P_D1);

   slope_above_d1              =  AndS (SLOPE, S_ABOVE, P_D1);
   slope_below_d1              =  AndS (SLOPE, S_BELOW, P_D1);
   slope_up_d1                 =  AndS (SLOPE, S_UP,    P_D1);
   slope_down_d1               =  AndS (SLOPE, S_DOWN,  P_D1);   

   ma_7_up_d1                  =  AndS (MA_7,  S_UP,    P_D1);
   ma_7_down_d1                =  AndS (MA_7,  S_DOWN,  P_D1);
   ma_7_above_d1               =  AndS (MA_7,  S_ABOVE, P_D1);
   ma_7_below_d1               =  AndS (MA_7,  S_BELOW, P_D1);

 

   ftrix_above                 = All (FTRIX, S_ABOVE);
   ftrix_below                 = All (FTRIX, S_BELOW);   
   ftrix_up                    = All (FTRIX, S_UP);
   ftrix_down                  = All (FTRIX, S_DOWN);
   ftrix_exitbuy               = All (FTRIX, S_EXIT_BUY);
   ftrix_exitsell              = All (FTRIX, S_EXIT_SELL);
   ftrix_cross_up              = All (FTRIX, S_CROSS_UP);
   ftrix_cross_down            = All (FTRIX, S_CROSS_DOWN);


   strix_up                    = All (STRIX, S_UP);
   strix_down                  = All (STRIX, S_DOWN);
   strix_above                 = All (STRIX, S_ABOVE);
   strix_below                 = All (STRIX, S_BELOW);   
   
   slope_up                    = All (SLOPE, S_UP);
   slope_down                  = All (SLOPE, S_DOWN);
   slope_above                 = All (SLOPE, S_ABOVE);
   slope_below                 = All (SLOPE, S_BELOW);

   coral_up                    = All (CORAL, S_UP);
   coral_down                  = All (CORAL, S_DOWN);
   coral_above                 = All (CORAL, S_ABOVE);
   coral_below                 = All (CORAL, S_BELOW);
   coral_cross_up              = All (CORAL, S_CROSS_UP);
   coral_cross_down            = All (CORAL, S_CROSS_DOWN);

   ichi_above                  = All (ICHIMOKU, S_ABOVE);
   ichi_below                  = All (ICHIMOKU, S_BELOW);
   ichi_touched                = All (ICHIMOKU, S_TOUCHED);
 

   upfractal_above             = All (UPFRACTAL,   S_ABOVE);
   downfractal_below           = All (DOWNFRACTAL, S_BELOW);
   res_above                   = All (RESISTANCE,  S_ABOVE);
   sup_below                   = All (SUPPORT,     S_BELOW);

   upfractal_alert             = All (UPFRACTAL,   S_ALERT);
   downfractal_alert           = All (DOWNFRACTAL, S_ALERT);

         
   upfractal_changed           = All (UPFRACTAL,   S_CHANGED);
   downfractal_changed         = All (DOWNFRACTAL, S_CHANGED);

   res_changed                 = All (RESISTANCE, S_CHANGED);
   sup_changed                 = All (SUPPORT,    S_CHANGED);


// STERM
   ftrix_up_s                  = All_s (FTRIX, S_UP);
   ftrix_down_s                = All_s (FTRIX, S_DOWN);
   ftrix_above_s               = All_s (FTRIX, S_ABOVE);
   ftrix_below_s               = All_s (FTRIX, S_BELOW);

   ftrix_exitbuy_s             = All_s (FTRIX, S_EXIT_BUY);
   ftrix_exitsell_s            = All_s (FTRIX, S_EXIT_SELL);
   ftrix_cross_up_s            = All_s (FTRIX, S_CROSS_UP);
   ftrix_cross_down_s          = All_s (FTRIX, S_CROSS_DOWN);


   strix_up_s                  = All_s (STRIX, S_UP);
   strix_down_s                = All_s (STRIX, S_DOWN);
   strix_above_s               = All_s (STRIX, S_ABOVE);
   strix_below_s               = All_s (STRIX, S_BELOW);


   slope_up_s                  = All_s (SLOPE, S_UP);
   slope_down_s                = All_s (SLOPE, S_DOWN);
   slope_above_s               = All_s (SLOPE, S_ABOVE);
   slope_below_s               = All_s (SLOPE, S_BELOW);
   slope_cross_up_s            = All_s (SLOPE, S_CROSS_UP);
   slope_cross_down_s          = All_s (SLOPE, S_CROSS_DOWN);
   

   coral_up_s                  = All_s (CORAL, S_UP);
   coral_down_s                = All_s (CORAL, S_DOWN);
   coral_above_s               = All_s (CORAL, S_ABOVE);
   coral_below_s               = All_s (CORAL, S_BELOW);
   coral_cross_up_s            = All_s (CORAL, S_CROSS_UP);
   coral_cross_down_s          = All_s (CORAL, S_CROSS_DOWN);
   
   ichi_above_s                = All_s (ICHIMOKU, S_ABOVE);
   ichi_below_s                = All_s (ICHIMOKU, S_BELOW);
   ichi_cross_up_s             = All_s (ICHIMOKU, S_CROSS_UP);
   ichi_cross_down_s           = All_s (ICHIMOKU, S_CROSS_DOWN);
   
   
   upfractal_above_s           = All_s (UPFRACTAL,   S_ABOVE);
   downfractal_below_s         = All_s (DOWNFRACTAL, S_BELOW);
   res_above_s                 = All_s (RESISTANCE,  S_ABOVE);
   sup_below_s                 = All_s (SUPPORT,     S_BELOW);
         
   upfractal_changed_s         = All_s (UPFRACTAL,   S_CHANGED);
   downfractal_changed_s       = All_s (DOWNFRACTAL, S_CHANGED);

   res_changed_s               = All_s (RESISTANCE, S_CHANGED);
   sup_changed_s               = All_s (SUPPORT,    S_CHANGED);

   
   
   ma_7_up_m30                 = AndS (MA_7, S_UP,   P_M30);
   ma_7_down_m30               = AndS (MA_7, S_DOWN, P_M30);      

   ma_7_angle_d1               = SValue (MA_7, S_ANGLE, P_D1);      
   slope_angle_d1              = SValue (SLOPE, S_ANGLE, P_D1);      

   slope_angle_m30             = SValue (SLOPE, S_ANGLE,   P_M30);
   slope_current_m30           = SValue (SLOPE, S_CURRENT, P_M30);
   ma_200_angle_m30            = SValue (MA_200, S_ANGLE,   P_M30);     
   ma_200_current_m30          = SValue (SLOPE, S_CURRENT, P_M30);
   ma_7_angle_m30              = SValue (MA_7, S_ANGLE,   P_M30);     
   ma_7_current_m30            = SValue (MA_7, S_CURRENT, P_M30);
   volume_100_up               = SValue (VOLUME_UP,  S_CURRENT, P_H1);  //100 = 100 minutes MTerm so
   volume_100_up_prev          = SValue (VOLUME_UP,  S_PREVIOUS,P_H1);   
   volume_100_down             = SValue (VOLUME_DOWN,S_CURRENT,P_H1);
   volume_100_down_prev        = SValue (VOLUME_DOWN,S_PREVIOUS,P_H1);      
   divergence_m30              = SValue (DIVERGENCE, S_CURRENT, P_M30);              

   slope_angle_m5              = SValue (SLOPE, S_ANGLE, P_M5);
   slope_current_m5            = SValue (SLOPE, S_CURRENT, P_M5);
   ma_200_angle_m5             = SValue (MA_200, S_ANGLE, P_M5);     
   ma_200_angle_m1             = SValue (MA_200, S_ANGLE, P_M1);     
   ma_200_current_m5           = SValue (SLOPE, S_CURRENT, P_M5);
   ma_200_angle_m5_prev        = SValue (MA_200, S_PANGLE,  P_M5);
   slope_angle_m5_prev         = SValue (SLOPE, S_PANGLE,  P_M5);
   velocity_m5                 = SValue (VELOCITY,S_CURRENT,P_M5);
   velocity_m5_prev            = SValue (VELOCITY,S_PREVIOUS,P_M5);
   divergence_m5               = SValue (DIVERGENCE, S_CURRENT, P_M5);      
   
   GetSystemOrientation1 ();

   for (p = P_D1; p <= P_W1; p++)
   {
      if (AndS (TMA_T_S, S_BUY, p))    
      {
         LTerm_Comments[i]     = "NB 10.2 EA RULE, BUY Signal : " + PeriodName[p];        
         LTerm_Orientation[i]  = ORT_UP; 
         LTerm_TOrientation[i] = ORT_UP; 
         LTerm_Action[i]       = OP_BUY;
         LTerm_Analyse[i]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Long Term NANNING BOB BUY Signal for period " + PeriodName[p]);    
         } 
         i++;       
      }
      if (AndS (TMA_T_S, S_SELL,  p))
      {
         LTerm_Comments[i]     = "NB 10.2 EA RULE, SELL Signal : "+ PeriodName[p];        
         LTerm_Orientation[i]  = ORT_DOWN; 
         LTerm_TOrientation[i] = ORT_DOWN; 
         LTerm_Action[i]       = OP_SELL;
         LTerm_Analyse[i]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Long Term NANNING BOB SELL Signal for period " + PeriodName[p]);           
         }
         i++;       
      }   

      if (AndS (TMA_S, S_BUY, p))    
      {
         LTerm_Comments[i]     = "Extreme TMA EA RULE, BUY Signal : " + PeriodName[p];        
         LTerm_Orientation[i]  = ORT_UP; 
         LTerm_TOrientation[i] = ORT_UP; 
         LTerm_Action[i]       = OP_BUY;
         LTerm_Analyse[i]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected an extreme zone. We have a Long Term Extreme T M A BUY Signal for period " + PeriodName[p]);    
         } 
         i++;       
      }
      if (AndS (TMA_S, S_SELL,  p))
      {
         LTerm_Comments[i]     = "Extreme TMA EA RULE, SELL Signal : "+ PeriodName[p];        
         LTerm_Orientation[i]  = ORT_DOWN; 
         LTerm_TOrientation[i] = ORT_DOWN; 
         LTerm_Action[i]       = OP_SELL;
         LTerm_Analyse[i]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected an extreme zone. We have a Long Term Extreme T M A SELL Signal for period " + PeriodName[p]);           
         }
         i++;       
      }   
      if (AndS (TRENDLINE, S_BUY, p))    
      {
         LTerm_Comments[i]     = "SYMPHONY EA RULE, BUY Signal : " + PeriodName[p];        
         LTerm_Orientation[i]  = ORT_UP; 
         LTerm_TOrientation[i] = ORT_UP; 
         LTerm_Action[i]       = OP_BUY;
         LTerm_Analyse[i]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Long Term SYMPHONY EA RULE BUY Signal for period " + PeriodName[p]);    
         } 
         i++;       
      }
      if (AndS (TRENDLINE, S_SELL,  p))
      {
         LTerm_Comments[i]     = "SYMPHONY EA RULE, SELL Signal : "+ PeriodName[p];        
         LTerm_Orientation[i]  = ORT_DOWN; 
         LTerm_TOrientation[i] = ORT_DOWN; 
         LTerm_Action[i]       = OP_SELL;
         LTerm_Analyse[i]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Long Term SYMPHONY EA RULE SELL Signal for period " + PeriodName[p]);         
         }
         i++;       
      }   
      if (AndS (FTRIX, S_BUY, p))    
      {
         LTerm_Comments[i]     = "THV EA RULE, BUY Signal : " + PeriodName[p];        
         LTerm_Orientation[i]  = ORT_UP; 
         LTerm_TOrientation[i] = ORT_UP; 
         LTerm_Action[i]       = OP_BUY;
         LTerm_Analyse[i]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Long Term THV EA Rule BUY Signal for period " + PeriodName[p]);    
            if (AndS (FTRIX, S_ABOVE, p) && AndS (STRIX, S_ABOVE, p))      
               Send_System ("Fast Trix and Slow Trix are above average line for period " + PeriodName[p]);   
         } 
         i++;       
      }
      if (AndS (FTRIX, S_SELL,  p))
      {
         LTerm_Comments[i]     = "THV EA RULE, SELL Signal : "+ PeriodName[p];        
         LTerm_Orientation[i]  = ORT_DOWN; 
         LTerm_TOrientation[i] = ORT_DOWN; 
         LTerm_Action[i]       = OP_SELL;
         LTerm_Analyse[i]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Long Term THV EA RULE SELL Signal for period " + PeriodName[p]);    
            if (AndS (FTRIX, S_BELOW, p) && AndS (STRIX, S_BELOW, p))      
               Send_System ("Fast Trix and Slow Trix are below average line for period " + PeriodName[p]);           
         }
         i++;       
      }
      if (AndS (FTRIX, S_RCROSSED,  p) && AndS (FTRIX, S_UP, p) && AndS (STRIX, S_UP, p)) 
      {
         LTerm_Comments[i]     = "BULL CROSS BUY Signal : "+ PeriodName[p];        
         LTerm_Orientation[i]  = ORT_UP; 
         LTerm_TOrientation[i] = ORT_UP; 
         LTerm_Action[i]       = OP_BUY;
         LTerm_Analyse[i]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
            Send_System ("System has detected a Long Term Bull Cross BUY Signal for period " + PeriodName[p]);        
         i++;       
      }
      if (AndS (FTRIX, S_RCROSSED,  p) && AndS (FTRIX, S_DOWN, p) && AndS (STRIX, S_DOWN, p)) 
      {
         LTerm_Comments[i]     = "BEAR CROSS SELL Signal : "+ PeriodName[p];        
         LTerm_Orientation[i]  = ORT_DOWN; 
         LTerm_TOrientation[i] = ORT_DOWN; 
         LTerm_Action[i]       = OP_SELL;
         LTerm_Analyse[i]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
            Send_System ("System has detected a Long Term Bear Cross Signal for period " + PeriodName[p]);        
         i++;       
      }
    }          
// FIBO

   if (MathAbs (Ask - SValue (OPEN, S_CURRENT, P_W1)) < AlertDistance[P_W1])
   {
      LTerm_Comments[j]     = "CRUCIAL FIBONACCI ZONE for period " + PeriodName[P_W1] + " : WAIT.";  
      LTerm_Analyse[j]      = OP_WAIT;         
      LTerm_Action[j]       = OP_BUYSELL;
      LTerm_Orientation[j]  = ORT_SIDEWAY; 
      LTerm_TOrientation[j] = ORT_SIDEWAY; 
      j++;
   }
   if (AndS (FIBOLEVEL, S_CHANGED, P_W1))
   {
      LTerm_Comments[j]     = "FIBONACCI LEVEL CHANGED for period " + PeriodName[P_W1];   
      LTerm_Analyse[j]      = OP_WAIT;         
      LTerm_Action[j]       = OP_BUYSELL;
      LTerm_Orientation[j]  = ORT_SIDEWAY; 
      LTerm_TOrientation[j] = ORT_SIDEWAY; 
      j++;
   }
   
   if (AndS (FIBOLEVEL, S_BULL, P_W1))
   {
      if (Ask >=  SValue (FIBOLEVEL, S_CURRENT, P_W1))
      {
         LTerm_Comments[j]     = "Above Fibonacci Buy Level zone for period " + PeriodName[P_W1];   
         LTerm_Analyse[j]      = OP_EXIT_SELL;         
         LTerm_Action[j]       = OP_BUY;
         LTerm_Orientation[j]  = ORT_UP; 
         LTerm_TOrientation[j] = ORT_UP; 
         j++;
      }
      else
      {
        if (Ask > SValue (FIBOSTOPLOSSLEVEL, S_CURRENT, P_W1))
        {
            LTerm_Comments[j]     = "Below Fibonacci Buy Level zone for period " + PeriodName[P_W1];   
            LTerm_Analyse[j]      = OP_SUSPEND;         
            LTerm_Action[j]       = OP_BUYSELL;
            LTerm_Orientation[j]  = ORT_UP; 
            LTerm_TOrientation[j] = ORT_SIDEWAY; 
            j++;
        }  
        else
        {
            LTerm_Comments[j]     = "Below Fibonacci Stop Loss Buy Level zone for period " + PeriodName[P_W1];   
            LTerm_Analyse[j]      = OP_EXIT_BUY;         
            LTerm_Action[j]       = OP_BUYSELL;
            LTerm_Orientation[j]  = ORT_DOWN; 
            LTerm_TOrientation[j] = ORT_REVERSING; 
            j++;
        }  
      }         
   }
   else   
   {
      if (Bid <=  SValue (FIBOLEVEL, S_CURRENT, P_W1))
      {
         LTerm_Comments[j]     = "Below Fibonacci Sell Level zone for period " + PeriodName[P_W1];   
         LTerm_Analyse[j]      = OP_EXIT_BUY;         
         LTerm_Action[j]       = OP_SELL;
         LTerm_Orientation[j]  = ORT_DOWN; 
         LTerm_TOrientation[j] = ORT_DOWN; 
         j++;
      }
      else
      {
        if (Bid < SValue (FIBOSTOPLOSSLEVEL, S_CURRENT, P_W1))
        {
            LTerm_Comments[j]     = "Above Fibonacci Sell Level zone for period " + PeriodName[P_W1];   
            LTerm_Analyse[j]      = OP_SUSPEND;         
            LTerm_Action[j]       = OP_BUYSELL;
            LTerm_Orientation[j]  = ORT_DOWN; 
            LTerm_TOrientation[j] = ORT_SIDEWAY; 
            j++;
        }  
        else
        {
            LTerm_Comments[j]     = "Above Fibonacci Stop Loss Sell Level zone for period " + PeriodName[P_W1];   
            LTerm_Analyse[j]      = OP_EXIT_SELL;         
            LTerm_Action[j]       = OP_BUYSELL;
            LTerm_Orientation[j]  = ORT_UP; 
            LTerm_TOrientation[j] = ORT_REVERSING; 
            j++;
        }  
      }         
   }      

   

   
   if (AndS (TMA_T_S, S_BULL, P_D1))
   {
     LTerm_Comments[i]     = "NanningBob Slope indicating an UP market. BUY ONLY"; 
     LTerm_Orientation[i]  = ORT_UP; 
     LTerm_TOrientation[i] = ORT_UP;      
     LTerm_Action[i]       = OP_BUY;
     LTerm_Analyse[i]      = OP_BUY;
     i++;       
   }
   else
   if (AndS (TMA_T_S, S_BEAR, P_D1))
   {
     LTerm_Comments[i]     = "NanningBob Slope indicating a DOWN market. SELL ONLY"; 
     LTerm_Orientation[i]  = ORT_DOWN; 
     LTerm_TOrientation[i] = ORT_DOWN;      
     LTerm_Action[i]       = OP_SELL;
     
     LTerm_Analyse[i]      = OP_SELL;
     i++;       
   }
   else
   {
     LTerm_Comments[i]     = "NaningBob Slope indicating market in RANGE. SIDEWAY Market"; 
     LTerm_Orientation[i]  = ORT_SIDEWAY; 
     LTerm_TOrientation[i] = ORT_SIDEWAY;      
     LTerm_Action[i]       = OP_BUYSELL;
     LTerm_Analyse[i]      = OP_BUYSELL;
     i++;       
   }
   
   
   
   if (upfractal_above_d1)
   {   
     LTerm_Comments[i]     = "Market is above fractal D1 so we have an indication of an UP market"; 
     LTerm_Orientation[i]  = ORT_UP; 
     LTerm_TOrientation[i] = ORT_UP;      
     LTerm_Action[i]       = OP_BUY;
     LTerm_Analyse[i]      = OP_BUY;
     i++;       
     if (downfractal_changed_d1)
     {
        LTerm_Comments[i]     = "Down fractal has changed, market is indicating the continuation of a bullish market"; 
        LTerm_Orientation[i]  = ORT_UP;                             
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD; 
        LTerm_Action[i]       = OP_BUY; 
        i++; 
     }
     if (ma_7_angle_d1 > 0 && ma_7_above_d1 && SValue (DIVERGENCE, S_CURRENT, P_D1) > 0) 
     {
        LTerm_Comments[i]     = "ma_7 angle is up, price is above moving average and divergence is positif, hold your position"; 
        LTerm_Orientation[i]  = ORT_UP;                     
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_BUY;        
        i++;
     }     
     if (res_alert_d1)
     {
        LTerm_Comments[i]     = "Price is approaching resistance, hold your position"; 
        LTerm_Orientation[i]  = ORT_UP;                     
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_BUY;        
        i++;
     }

     if (upfractal_alert_d1)
     {     
        LTerm_Comments[i]     = "Price is approaching one day up fractal, hold your position"; 
        LTerm_Orientation[i]  = ORT_UP;                     
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_BUY;        
        i++;
     }
     if (ftrix_up_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast trix is up, market is indicating an uptrend."; 
        LTerm_Orientation[i]  = ORT_UP;                     
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_BUY;        
        i++;
     } 
     if (upfractal_changed_d1)
     {
        LTerm_Comments[i]     = "D1 Up fractal has changed, market is indicating a resistance at this point"; 
        LTerm_Orientation[i]  = ORT_DOWN;                     
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL;
        i++;
     }          
     if (sup_alert_d1)
     {
        LTerm_Comments[i]     = "Price is approaching support"; 
        LTerm_Orientation[i]  = ORT_DOWN;               
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL;
        i++;
     }
     if (sup_below_d1)
     {
        LTerm_Comments[i]     = "D1 support broken."; 
        LTerm_Orientation[i]  = ORT_DOWN;               
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL;
        i++;
     }
     if (upfractal_changed_d1)
     {
        LTerm_Comments[i]     = "D1 Up fractal has changed, market is indicating a resistance at this point."; 
        LTerm_Orientation[i]  = ORT_DOWN;               
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL;                 
        i++;
     }

     if (ma_7_down_d1 && ma_7_angle_d1 > 0)
     {
        LTerm_Comments[i]     = "ma_7 angle is indicating an angle divergence."; 
        LTerm_Orientation[i]  = ORT_DOWN;               
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL;                 
        i++;
     } 
     if (ftrix_down_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast trix is indicating a downtrend."; 
        LTerm_Orientation[i]  = ORT_DOWN;       
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL; 
        i++;                        
     } 
     if (ftrix_exitbuy_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast trix is changing trend indicating to exit your buy position."; 
        LTerm_Orientation[i]  = ORT_DOWN;       
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL;                 
        i++;
     } 
     if (slope_up_d1 && slope_below_d1)
     {
        LTerm_Comments[i]     = "Price is below slope this is an indication of a downtrend."; 
        LTerm_Orientation[i]  = ORT_DOWN;       
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_BUYSELL;                 
        i++;     
     }
     if (ftrix_cross_down_d1) 
     {
        LTerm_Comments[i]     = "Exit your buy position SELL"; 
        LTerm_Orientation[i]  = ORT_DOWN;            
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;
        LTerm_Action[i]       = OP_SELL;
        i++;     
     }
   }  
   else
   if (downfractal_below_d1)
   {
     LTerm_Comments[i]     = "Market is below fractal D1 so we have an indication of a DOWN market"; 
     LTerm_Orientation[i]  = ORT_DOWN; 
     LTerm_TOrientation[i] = ORT_DOWN; 
     LTerm_Analyse[i]      = OP_HOLD; 
     LTerm_Action[i]       = OP_SELL;      
     i++; 
     
     if (upfractal_changed_d1)
     {
        LTerm_Comments[i]     = "Up fractal has changed, market is indicating the continuation of a bearish market"; 
        LTerm_Orientation[i]  = ORT_DOWN;         
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD; 
        LTerm_Action[i]       = OP_SELL; 
        i++; 
     }     
     if (ma_7_angle_d1 < 0 && ma_7_below_d1 && SValue (DIVERGENCE, S_CURRENT, P_D1) < 0) 
     {
        LTerm_Comments[i]     = "ma_7 angle is down, price is below moving average and divergence is negatif, hold your position"; 
        LTerm_Orientation[i]  = ORT_DOWN;    
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_SELL;        
        i++; 
     }     
     if (sup_alert_d1)
     {
        LTerm_Comments[i]     = "Price is approaching support, hold your position"; 
        LTerm_Orientation[i]  = ORT_DOWN;       
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_SELL;        
        i++;
     }
     if (downfractal_alert_d1)
     {     
        LTerm_Comments[i]     = "Price is approaching one day down fractal, hold your position"; 
        LTerm_Orientation[i]  = ORT_DOWN;    
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_SELL;        
        i++;
     }
     if (ftrix_down_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast trix is down, market is indicating a downtrend."; 
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_SHARP; 
        LTerm_Analyse[i]      = OP_HOLD;
        LTerm_Action[i]       = OP_SELL;        
        i++;
     } 

     if (res_alert_d1)
     {
        LTerm_Comments[i]     = "Price is approaching resistance."; 
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUYSELL;         
        i++;
     }
     if (res_above_d1)
     {
        LTerm_Comments[i]     = "D1 resistance broken."; 
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUYSELL;         
        i++;
     }
     
     if (ftrix_exitsell_d1) 
     {
        LTerm_Comments[i]     = "Fast trix is changing trend indicating to exit your sell position."; 
        LTerm_Orientation[i]  = ORT_UP;      
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUYSELL;         
        i++;
     } 
     if (downfractal_changed_d1)
     {
        LTerm_Comments[i]     = "D1 Down fractal has changed, market is indicating a support at this point."; 
        LTerm_Orientation[i]  = ORT_UP;       
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUYSELL;         
        i++;
     }
     if (ma_7_up_d1 && ma_7_angle_d1 < 0)
     {
        LTerm_Comments[i]     = "ma_7 angle is indicating an angle divergence."; 
        LTerm_Orientation[i]  = ORT_UP;       
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUYSELL;              
        i++;
     } 
     if (ftrix_up_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast trix is indicating an uptrend."; 
        LTerm_Orientation[i]  = ORT_UP;       
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUYSELL;                 
        i++;
     } 
     if (slope_down_d1 && slope_above_d1)
     {
        LTerm_Comments[i]     = "Price is above D1 slope this is an indication of a uptrend."; 
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUYSELL;         
        i++;        
     }
     if (ftrix_cross_up_d1) 
     {
        LTerm_Comments[i]     = "Exit your sell position BUY"; 
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;
        LTerm_Action[i]       = OP_BUY;
        i++;
     }
   }  
   else
   {
     LTerm_Comments[i]     = "Market is in a CORRECTIVE PHASE : SIDEWAY market."; 
     LTerm_Orientation[i]  = ORT_SIDEWAY; 
     LTerm_TOrientation[i] = ORT_NORMAL; 
     LTerm_Action[i]       = OP_BUYSELL;        
     LTerm_Analyse[i]      = OP_BUYSELL;        
     i++; 
    
     if (ma_7_angle_d1 > 40 && ma_7_above_d1 && SValue (DIVERGENCE, S_CURRENT, P_D1) > 0) 
     {
        LTerm_Comments[i]     = "ma_7 angle is up, price is above one day moving average and divergence is positif, hold your position"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_UP; 
        LTerm_Action[i]       = OP_BUY;        
        i++;
     }     

     if (res_alert_d1)
     {
        LTerm_Comments[i]     = "Price is approaching D1 resistance"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_UP; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     }
     if (res_above_d1)
     {
        LTerm_Comments[i]     = "D1 Resistance broken but market can retrace"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_UP; 
        LTerm_Action[i]       = OP_BUY;              
        i++;
     }
     if (upfractal_alert_d1)
     {     
        LTerm_Comments[i]     = "Price is approaching D1 up fractal, prepare to buy"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_UP; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     }
     if (ma_7_angle_d1 < -40 && ma_7_below_d1 && SValue (DIVERGENCE, S_CURRENT, P_D1) < 0) 
     {
        LTerm_Comments[i]     = "D1 ma_7 angle is down, price is below moving average and divergence is negatif"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_DOWN; 
        LTerm_Action[i]       = OP_SELL;        
        i++;
     }     
     
     if (sup_alert_d1)
     {
        LTerm_Comments[i]     = "Price is approaching D1 support."; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_DOWN; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     }
     if (sup_below_d1)
     {
        LTerm_Comments[i]     = "D1 Support broken but market can retrace"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;  
        LTerm_Orientation[i]  = ORT_DOWN;               
        LTerm_TOrientation[i] = ORT_DOWN; 
        LTerm_Action[i]       = OP_SELL;        
        i++;
     }

     if (downfractal_alert_d1)
     {     
        LTerm_Comments[i]     = "Price is approaching D1 down fractal, prepare to sell"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY; 
        LTerm_Orientation[i]  = ORT_DOWN;                
        LTerm_TOrientation[i] = ORT_DOWN; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     }

     if (upfractal_changed_d1)
     {
        LTerm_Comments[i]     = "D1 up fractal has changed, market is indicating a resistance at this point"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_REVERSING;         
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     }
     if (downfractal_changed_d1)
     {
        LTerm_Comments[i]     = "D1 down fractal has changed, market is indicating a support at this point"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     }

     if (ma_7_down_d1 && ma_7_angle_d1 > 0)
     {
        LTerm_Comments[i]     = "D1 ma_7 angle is indicating an angle divergence"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     } 
     if (ma_7_up_d1 && ma_7_angle_d1 < 0)
     {
        LTerm_Comments[i]     = "D1 ma_7 angle is indicating an angle divergence"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     } 

     if (ftrix_down_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast Trix is indicating a downtrend"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Action[i]       = OP_SELL; 
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_DOWN; 
        i++;
     }      
     if (ftrix_up_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast Trix is indicating an uptrend"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Action[i]       = OP_BUY; 
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_UP; 
        i++;
     }      

     if (ftrix_exitbuy_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast Trix is changing trend : Exit buy"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     } 
     if (ftrix_exitsell_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast Trix is changing trend : Exit Sell"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     } 
     
     if (slope_up_d1 && slope_below_d1)
     {
        LTerm_Comments[i]     = "Price is below D1 slope this is an indication of a downtrend"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Action[i]       = OP_SELL;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        i++;
     }
     if (slope_down_d1&& slope_above_d1)
     {
        LTerm_Comments[i]     = "Price is above D1 slope this is an indication of an up trend"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Action[i]       = OP_BUY;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        i++;
     }

     if (ftrix_cross_down_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast Trix crossed exit your buy position. SELL"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_SELL;        
        i++;     
     }
     if (ftrix_cross_up_d1) 
     {
        LTerm_Comments[i]     = "D1 Fast Trix crossed exit your sell position  BUY"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUY;        
        i++;     
     }

     if (upfractal_changed_d1)
     {
        LTerm_Comments[i]     = "D1 up fractal has changed, market is indicating a resistance at this point"; 
        LTerm_Analyse[i]      = OP_EXIT_BUY;        
        LTerm_Orientation[i]  = ORT_DOWN; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++; 
     }
     if (downfractal_changed_d1)
     {
        LTerm_Comments[i]     = "D1 down fractal has changed, market is indicating a support at this point"; 
        LTerm_Analyse[i]      = OP_EXIT_SELL;        
        LTerm_Orientation[i]  = ORT_UP; 
        LTerm_TOrientation[i] = ORT_REVERSING; 
        LTerm_Action[i]       = OP_BUYSELL;        
        i++;
     }
   }

// FIBO 
   
   if (MathAbs (Ask - SValue (OPEN, S_CURRENT, P_D1)) < AlertDistance[P_D1])
   {
      MTerm_Comments[j]     = "CRUCIAL FIBONACCI ZONE for period " + PeriodName[P_D1] + " : WAIT.";   
      MTerm_Analyse[j]      = OP_WAIT;         
      MTerm_Action[j]       = OP_BUYSELL;
      MTerm_Orientation[j]  = ORT_SIDEWAY; 
      MTerm_TOrientation[j] = ORT_SIDEWAY; 
      j++;
   }
   if (AndS (FIBOLEVEL, S_CHANGED, P_D1))
   {
      MTerm_Comments[j]     = "FIBONACCI LEVEL CHANGED for period " + PeriodName[P_D1];   
      MTerm_Analyse[j]      = OP_WAIT;         
      MTerm_Action[j]       = OP_BUYSELL;
      MTerm_Orientation[j]  = ORT_SIDEWAY; 
      MTerm_TOrientation[j] = ORT_SIDEWAY; 
      j++;
   }
   
   if (AndS (FIBOLEVEL, S_BULL, P_D1))
   {
      if (Ask >=  SValue (FIBOLEVEL, S_CURRENT, P_D1))
      {
         MTerm_Comments[j]     = "Above Fibonacci Buy Level zone for period " + PeriodName[P_D1];   
         MTerm_Analyse[j]      = OP_EXIT_SELL;         
         MTerm_Action[j]       = OP_BUY;
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP; 
         j++;
      }
      else
      {
        if (Ask > SValue (FIBOSTOPLOSSLEVEL, S_CURRENT, P_D1))
        {
            MTerm_Comments[j]     = "Below Fibonacci Buy Level zone for period " + PeriodName[P_D1]; 
            MTerm_Analyse[j]      = OP_SUSPEND;         
            MTerm_Action[j]       = OP_BUYSELL;
            MTerm_Orientation[j]  = ORT_UP; 
            MTerm_TOrientation[j] = ORT_SIDEWAY; 
            j++;
        }  
        else
        {
            MTerm_Comments[j]     = "Below Fibonacci Stop Loss Buy Level zone for period " + PeriodName[P_D1];   
            MTerm_Analyse[j]      = OP_EXIT_BUY;         
            MTerm_Action[j]       = OP_BUYSELL;
            MTerm_Orientation[j]  = ORT_DOWN; 
            MTerm_TOrientation[j] = ORT_REVERSING; 
            j++;
        }  
      }         
   }
   else   
   {
      if (Bid <=  SValue (FIBOLEVEL, S_CURRENT, P_D1))
      {
         MTerm_Comments[j]     = "Below Fibonacci Sell Level zone for period " + PeriodName[P_D1];   
         MTerm_Analyse[j]      = OP_EXIT_BUY;         
         MTerm_Action[j]       = OP_SELL;
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         j++;
      }
      else
      {
        if (Bid < SValue (FIBOSTOPLOSSLEVEL, S_CURRENT, P_D1))
        {
            MTerm_Comments[j]     = "Above Fibonacci Sell Level zone for period " + PeriodName[P_D1];   
            MTerm_Analyse[j]      = OP_SUSPEND;         
            MTerm_Action[j]       = OP_BUYSELL;
            MTerm_Orientation[j]  = ORT_DOWN; 
            MTerm_TOrientation[j] = ORT_SIDEWAY; 
            j++;
        }  
        else
        {
            MTerm_Comments[j]     = "Above Fibonacci Stop Loss Sell Level zone for period " + PeriodName[P_D1];  
            MTerm_Analyse[j]      = OP_EXIT_SELL;         
            MTerm_Action[j]       = OP_BUYSELL;
            MTerm_Orientation[j]  = ORT_UP; 
            MTerm_TOrientation[j] = ORT_REVERSING; 
            j++;
        }  
      }         


   }      
// D1 M_Term
   double sLevel     = SValue (PIVOT_RESISTANCE, S_CURRENT, P_D1);      //LastResistance[1][P_D1];
   double bLevel     = SValue (PIVOT_SUPPORT,    S_CURRENT, P_D1);      //LastSupport[1][P_D1];
   
   
   if (AndS (PIVOT_RESISTANCE, S_ALERT, P_D1) ||
       AndS (PIVOT_HIGH,       S_ALERT, P_D1))
   { 
      LTerm_Comments[i]     = "Pivot zone, wait for an indication"; 
      LTerm_Orientation[i]  = ORT_UP; 
      LTerm_TOrientation[i] = ORT_UP; 
      LTerm_Analyse[i]      = OP_SUSPEND;     
      LTerm_Action[i]       = OP_SUSPEND;         
      MTerm_Comments[j]     = LTerm_Comments[i];
      MTerm_Analyse[j]      = OP_SUSPEND;         
      MTerm_Action[j]       = OP_SUSPEND;
      MTerm_Orientation[j]  = ORT_UP; 
      MTerm_TOrientation[j] = ORT_UP; 
      j++;
      i++; 
   }     
   if ( AndS (PIVOT_SUPPORT, S_ALERT, P_D1) ||
        AndS (PIVOT_LOW,    S_ALERT,  P_D1))
   {
      LTerm_Comments[i]     = "Pivot zone, wait for an indication"; 
      LTerm_Orientation[i]  = ORT_DOWN; 
      LTerm_TOrientation[i] = ORT_DOWN; 
      LTerm_Analyse[i]      = OP_SUSPEND;         
      LTerm_Action[i]       = OP_SUSPEND;         
      MTerm_Comments[j]     = LTerm_Comments[i];
      MTerm_Analyse[j]      = OP_SUSPEND;         
      MTerm_Action[j]       = OP_SUSPEND;
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_DOWN; 
      j++;
      i++; 
   }

   if (LastResistance[1][P_D1] > LastHigh[1][P_D1])
   {
      if (Ask > LastResistance[1][P_D1] && AndS(PIVOT_RESISTANCE, S_ALERT, P_D1) == 0)
      {
         LTerm_Comments[i]     = "Pivot zone, resistance broken bullish trend"; 
         LTerm_Orientation[i]  = ORT_UP; 
         LTerm_TOrientation[i] = ORT_UP; 
         LTerm_Analyse[i]      = OP_EXIT_SELL;     
         LTerm_Action[i]       = OP_BUY;        
         MTerm_Comments[j]     = LTerm_Comments[i];
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP;          
         MTerm_Analyse[j]      = OP_EXIT_SELL;
         MTerm_Action[j]       = OP_BUY; 
         j++;
         i++; 
         sPivotZone = "RED";     
      }
   }
   else
   {
      if (Ask > LastHigh[1][P_D1] && AndS(PIVOT_HIGH, S_ALERT, P_D1) == 0)
      {
         LTerm_Comments[i]     = "Pivot zone, Yesterdays high broken , bullish trend";  
         LTerm_Orientation[i]  = ORT_UP; 
         LTerm_TOrientation[i] = ORT_UP; 
         LTerm_Analyse[i]      = OP_EXIT_SELL;     
         LTerm_Action[i]       = OP_BUY;        
         MTerm_Comments[j]     = LTerm_Comments[i];
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP;          
         MTerm_Analyse[j]      = OP_EXIT_SELL;
         MTerm_Action[j]       = OP_BUY;   
         i++;          
         j++;
         sPivotZone = "RED";               
      }
   }
   
   if (LastSupport[1][P_D1] < LastLow[1][P_D1])
   {
      if (Bid < LastSupport[1][P_D1] && AndS(PIVOT_SUPPORT, S_ALERT, P_D1) == 0)
      {
         LTerm_Comments[i]     = "Pivot zone, support broken, bearish trend"; 
         LTerm_Orientation[i]  = ORT_DOWN; 
         LTerm_TOrientation[i] = ORT_DOWN; 
         LTerm_Analyse[i]      = OP_EXIT_BUY;     
         LTerm_Action[i]       = OP_SELL;        
         MTerm_Comments[j]     = LTerm_Comments[i];
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN;          
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         MTerm_Action[j]       = OP_SELL;  
         j++;
         i++; 
         sPivotZone = "RED";              
      }
   }
   else
   {
      if (Bid < LastLow[1][P_D1] && AndS(PIVOT_LOW, S_ALERT, P_D1) == 0)
      {
         LTerm_Comments[i]     = "Pivot zone, yesterdays low broken, bearish trend"; 
         LTerm_Orientation[i]  = ORT_DOWN; 
         LTerm_TOrientation[i] = ORT_DOWN; 
         LTerm_Analyse[i]      = OP_EXIT_BUY;     
         LTerm_Action[i]       = OP_SELL;        
         MTerm_Comments[j]     = LTerm_Comments[i];
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         MTerm_Action[j]       = OP_SELL;   
         j++;
         i++; 
         sPivotZone = "RED";     
      }      
   }
   

   if (((LastHigh[2][P_H1] > sLevel ||  LastClose[2][P_H1] >= sLevel) &&  
         LastOpen[2][P_H1] < sLevel) && LastClose[1][P_H1] <= sLevel)
   {
      MTerm_Comments[j]      = "Pivot zone, reversing , bearish trend";
      MTerm_Orientation[j]   = ORT_DOWN; 
      MTerm_TOrientation[j]  = ORT_REVERSING; 
      MTerm_Analyse[j]       = OP_EXIT_BUY;
      MTerm_Action[j]        = OP_SELL;        
      j++;
   }
   
   if (((LastLow[2][P_H1] < bLevel || LastClose[2][P_H1] <= bLevel) &&  
         LastOpen[2][P_H1] > bLevel) &&  LastClose[1][P_H1] >= bLevel)
   {
      MTerm_Comments[j]      = "Pivot zone, reversing , bullish trend";
      MTerm_Orientation[j]   = ORT_UP; 
      MTerm_TOrientation[j]  = ORT_REVERSING; 
      MTerm_Analyse[j]       = OP_EXIT_SELL;
      MTerm_Action[j]        = OP_BUY;        
      j++;
   }

   if (!AndS (PIVOT_RESISTANCE, S_ABOVE, P_D1) && !AndS (PIVOT_HIGH, S_ABOVE, P_D1) &&
       !AndS (PIVOT_SUPPORT, S_BELOW, P_D1)    && !AndS (PIVOT_LOW, S_ABOVE, P_D1))
   {    
         
      if (AndS (PIVOT_POINT, S_CROSS_DOWN, P_D1) && LastLow[1][P_D1] > SValue (PIVOT_POINT, S_CURRENT, P_D1))
      {
         MTerm_Comments[j]      = "Crossed down PIVOT";
         MTerm_Orientation[j]   = ORT_DOWN; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_SELL;
         MTerm_Action[j]        = OP_SELL;   
         j++;
      }
      if (AndS (PIVOT_POINT, S_CROSS_UP, P_D1) && LastHigh[1][P_D1] < SValue (PIVOT_POINT, S_CURRENT, P_D1))
      {
         MTerm_Comments[j]      = "Crossed up PIVOT";
         MTerm_Orientation[j]   = ORT_UP; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUY;
         MTerm_Action[j]        = OP_BUY;   
         j++;
      }
      if (AndS (PIVOT_POINT, S_ALERT, P_D1))
      {   
         MTerm_Comments[j]      = "Alert PIVOT Center Pivot zone. Pick Target";
         MTerm_Orientation[j]   = ORT_SIDEWAY; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUYSELL;
         MTerm_Action[j]        = OP_BUYSELL;   
         j++;
      }
      if (AndS (PIVOT_POINT, S_ABOVE, P_D1))
      {   
         MTerm_Comments[j]      = "Above PIVOT Center Pivot zone. Pick Target";
         MTerm_Orientation[j]   = ORT_UP; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUYSELL;
         MTerm_Action[j]        = OP_BUYSELL;   
         j++;
      }
      if (AndS (PIVOT_POINT, S_BELOW, P_D1))
      {   
         MTerm_Comments[j]      = "Below PIVOT Center Pivot zone. Pick Target";
         MTerm_Orientation[j]   = ORT_DOWN; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUYSELL;
         MTerm_Action[j]        = OP_BUYSELL;   
         j++;
      }
      if (AndS (PIVOT_RESISTANCE, S_MIDDLE, P_D1))
      {   
         MTerm_Comments[j]      = "MID DISTANCE  PIVOT RESISTANCE.";
         MTerm_Orientation[j]   = ORT_UP; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUYSELL;
         MTerm_Action[j]        = OP_BUYSELL;   
         j++;
      }
      if (AndS (PIVOT_HIGH, S_MIDDLE, P_D1))
      {   
         MTerm_Comments[j]      = "MID DISTANCE  PIVOT HIGH.";
         MTerm_Orientation[j]   = ORT_UP; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUYSELL;
         MTerm_Action[j]        = OP_BUYSELL;   
         j++;
      }
      if (AndS (PIVOT_SUPPORT, S_MIDDLE, P_D1))
      {   
         MTerm_Comments[j]      = "MID DISTANCE  PIVOT SUPPORT.";
         MTerm_Orientation[j]   = ORT_DOWN; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUYSELL;
         MTerm_Action[j]        = OP_BUYSELL;   
         j++;
      }
      if (AndS (PIVOT_LOW, S_MIDDLE, P_D1))
      {   
         MTerm_Comments[j]      = "MID DISTANCE PIVOT LOW.";
         MTerm_Orientation[j]   = ORT_DOWN; 
         MTerm_TOrientation[j]  = ORT_REVERSING; 
         MTerm_Analyse[j]       = OP_BUYSELL;
         MTerm_Action[j]        = OP_BUYSELL;   
         j++;
      }
   }   
   sPivotZone = "GREEN"; 
   LTerm_Nbr = i;    
   
   int nbr_buy     = 0;
   int nbr_sell    = 0;
   int nbr_buysell = 0;

   LTermOrientation  = ORT_SIDEWAY;
   LTermTOrientation = ORT_SIDEWAY;               
      
   for (i = 0; i < LTerm_Nbr; i++)
    if (LTerm_Action[i] == OP_BUY)     nbr_buy++;          
    else
    if (LTerm_Action[i] == OP_SELL)    nbr_sell++;
    else
    if (LTerm_Action[i] == OP_BUYSELL) nbr_buysell++;
   
    if (nbr_buy == 0 && nbr_sell > 0)
    {
       LTermOrientation  = ORT_DOWN;
       LTermTOrientation = ORT_DOWN;
    }      
    else
    if (nbr_sell == 0 && nbr_buy > 0)
    {
       LTermOrientation  = ORT_UP;
       LTermTOrientation = ORT_UP;
    }
    else
    if (nbr_sell > nbr_buy)
    {
       LTermOrientation = ORT_DOWN;
       LTermTOrientation = ORT_SIDEWAY;
    }
    else
    if (nbr_buy > nbr_sell)
    {
       LTermOrientation = ORT_UP;
       LTermTOrientation = ORT_SIDEWAY;
    }
      
   if (LTermOrientation != LTermLastOrientation)
   {
     LTermLastOrientation = LTermOrientation;
     LTermTimeOrientation = TimeCurrent ();
   }


// MTERM


   if (res_above >= h4_h1_m30)
   {
      MTerm_Comments[j]     = "Market is above M30 H1 H4 resistance."; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_SHARP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }
   if (sup_below >= h4_h1_m30)
   {
      MTerm_Comments[j]     = "Market is below M30 H1 H4 support."; 
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_SHARP; 
      MTerm_Action[j]       = OP_SELL;
      MTerm_Analyse[j]      = OP_HOLD;
      j++;       
   }

//Rule 1   



   if (upfractal_above >= h4_h1_m30)
   {
      MTerm_Comments[j]     = "Market is above M30 H1 H4 fractals."; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_SHARP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_HOLD;
      j++;       
   }
   if (downfractal_below >= h4_h1_m30)
   {
      MTerm_Comments[j]     = "Market is below M30 H1 H4 fractals."; 
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_SHARP; 
      MTerm_Action[j]       = OP_SELL;
      MTerm_Analyse[j]      = OP_HOLD;
      j++;       
   }
   
   for (p = 3; p < 6; p++)
   {
      if (AndS (RESISTANCE, S_ABOVE, p))
      {
         MTerm_Comments[j]     = "Market is above resistance for period " + PeriodName[p];  
         MTerm_Orientation[j]  = ORT_UP;  
         MTerm_TOrientation[j] = ORT_UP;  
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_HOLD;
         j++; 
      }
      if (AndS (SUPPORT, S_BELOW, p))
      {
         MTerm_Comments[j]     = "Market is below support for period " + PeriodName[p];   
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_HOLD;
         j++;       
      }
   
   
      if (AndS (UPFRACTAL, S_ABOVE, p))
      {
         MTerm_Comments[j]     = "Market is above fractal for period " + PeriodName[p];  
         MTerm_Orientation[j]  = ORT_UP;  
         MTerm_TOrientation[j] = ORT_UP;  
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_HOLD;
         j++;       
      }
      if (AndS (DOWNFRACTAL, S_BELOW, p))
      {
         MTerm_Comments[j]     = "Market is below fractal for period " + PeriodName[p];
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_HOLD;
         j++;       
      }

      if (AndS (UPFRACTAL, S_ALERT, p))
      {
         MTerm_Comments[j]     = "Market is approaching up fractal for period " + PeriodName[p]; 
         MTerm_Orientation[j]  = ORT_UP;  
         MTerm_TOrientation[j] = ORT_UP;  
         MTerm_Action[j]       = OP_BUYSELL;
         MTerm_Analyse[j]      = OP_SUSPEND;
         j++;       
      }
      if (AndS (DOWNFRACTAL, S_ALERT, p))
      {
         MTerm_Comments[j]     = "Market is approaching down fractal for period " + PeriodName[p]; 
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_BUYSELL;
         MTerm_Analyse[j]      = OP_SUSPEND;
         j++;       
      }
      if (AndS (FTRIX, S_EXIT_BUY, p))
      {   
         MTerm_Comments[j]     = "Fast Trix is giving an exit buy signal for period " + PeriodName[p];   
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_REVERSING; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_EXIT_BUY;   
         j++;       
      }
      if (AndS (FTRIX, S_EXIT_SELL, p))
      {   
         MTerm_Comments[j]     = "Fast Trix is giving an exit sell signal for period " + PeriodName[p];          
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_REVERSING; 
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_EXIT_SELL;   
         j++;       
      }
      
   }
   if (slope_up >= h4_h1_m30 && slope_above >= h4_h1_m30)
   {
      MTerm_Comments[j]     = "Slope for M30 H1 H4 are up, price is above them"; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_SHARP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }  
   if (slope_down >= h4_h1_m30 && slope_below >= h4_h1_m30) 
   {
      MTerm_Comments[j]     = "Slope for M30 H1 H4 are down, price is below them"; 
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_SHARP; 
      MTerm_Action[j]       = OP_SELL;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }
   if (slope_above >= h4_h1_m30)
   {
      MTerm_Comments[j]     = "Slope for M30 H1 H4 : Price is above them."; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_REVERSING;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }  
   if (slope_below >= h4_h1_m30) 
   {
      MTerm_Comments[j]     = "Slope for M30 H1 H4 : Price is below them."; 
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_REVERSING; 
      MTerm_Action[j]       = OP_SELL;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }
   if (AndS (SLOPE, S_BELOW, P_H1) && AndS (ICHIMOKU, S_BELOW, P_H1)) 
   {
      MTerm_Comments[j]     = "Slope and Ichimuko below H1."; 
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_DOWN; 
      MTerm_Action[j]       = OP_SELL;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }
   if (AndS (SLOPE, S_ABOVE, P_H1) && AndS (ICHIMOKU, S_ABOVE, P_H1)) 
   {
      MTerm_Comments[j]     = "Slope and Ichimuko above H1."; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_UP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }  

   if (ftrix_up >= h4_h1_m30 && strix_up >= h4_h1_m30)      
   {        
      MTerm_Comments[j]     = "Fast Trix and Slow Trix H4, H1 and M30 are up."; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_SHARP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_EXIT_SELL;
      j++;
   }  
   if (ftrix_down >= h4_h1_m30 && strix_down >= h4_h1_m30)  
   {      
      MTerm_Comments[j]      = "Fast Trix and Slow Trix for H4, H1 and M30 are down."; 
      MTerm_Orientation[j]   = ORT_DOWN;  
      MTerm_TOrientation[j]  = ORT_SHARP;  
      MTerm_Action[j]        = OP_SELL;
      MTerm_Analyse[j]       = OP_EXIT_BUY;
      j++;
   }  
   
   if (ftrix_up >= h4_h1_m30)  
   {
      MTerm_Comments[j]     = "Fast Trix M30 H1 and H4 are all up."; 
      MTerm_Orientation[j]  = ORT_UP;   
      MTerm_TOrientation[j] = ORT_UP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }  

   if (ftrix_down >= h4_h1_m30) 
   {
      MTerm_Comments[j]     = "Fast Trix M30 H1 and H4 are all down."; 
      MTerm_Orientation[j]  = ORT_DOWN;  
      MTerm_TOrientation[j] = ORT_DOWN;  
      MTerm_Action[j]       = OP_SELL;
      MTerm_Analyse[j]      = OP_HOLD;
      j++; 
   }  

// Rule 2

   if (ftrix_up >= h4_h1 && strix_up >= h4_h1)      
   {        
      MTerm_Comments[j]     = "Fast Trix and Slow Trix H1 and H4 are up."; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_UP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_EXIT_SELL;
      j++;
   }  
   if (ftrix_down >= h4_h1 && strix_down >= h4_h1)  
   {      
      MTerm_Comments[j]      = "Fast Trix and Slow Trix for H1 and H4 are down"; 
      MTerm_Orientation[j]   = ORT_DOWN;  
      MTerm_TOrientation[j]  = ORT_DOWN;  
      MTerm_Action[j]        = OP_SELL;
      MTerm_Analyse[j]       = OP_EXIT_BUY;
      j++;
   }  
   if (ma_7_down_m30 && ma_7_angle_m30 > 0)
   {
      MTerm_Comments[j]     = "M30 m_7 angle is indicating an angle divergence."; 
      MTerm_Analyse[j]      = OP_EXIT_BUY;        
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_REVERSING; 
      MTerm_Action[j]       = OP_SELL;        
      j++;
   } 
   if (ma_7_up_m30 && ma_7_angle_m30 < 0)
   {
      MTerm_Comments[j]     = "M30 m_7 angle is indicating an angle divergence."; 
      MTerm_Analyse[j]      = OP_EXIT_SELL;        
      MTerm_Orientation[j]  = ORT_UP; 
      MTerm_TOrientation[j] = ORT_REVERSING; 
      MTerm_Action[j]       = OP_BUY;        
      j++;
   } 
   
   
   if (ma_200_angle_m30 < 0 &&
       slope_angle_m30 < 0 &&
       slope_current_m30 <  ma_200_current_m30)
   {
      MTerm_Comments[j]      = "M30 angle for slope and ma_200 moving average are down and slope is under ma_200."; 
      MTerm_Orientation[j]   = ORT_DOWN;  
      MTerm_TOrientation[j]  = ORT_DOWN;  
      MTerm_Action[j]        = OP_SELL;
      MTerm_Analyse[j]       = OP_EXIT_BUY;
      j++;
   }
   else
   if (ma_200_angle_m30 > 0 &&
       slope_angle_m30 > 0 &&
       slope_current_m30 >  ma_200_current_m30) 
   {
      MTerm_Comments[j]     = "M30 angle for slope and ma_200 moving average are up and slope is above ma_200."; 
      MTerm_Orientation[j]  = ORT_UP;  
      MTerm_TOrientation[j] = ORT_UP;  
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_EXIT_SELL;
      j++;
   }   

   if (ftrix_up  >= h4 && ftrix_down >= h1) 
   {       
      if (AndS (FTRIX, S_UP, P_M30)) 
      {
         MTerm_Comments[j]      = "Fast Trix M30 is up while H1 and H4 are opposite.. hold your H4 buy position."; 
         MTerm_TOrientation[j]  = ORT_UP;  
         MTerm_Orientation[j]   = ORT_UP;  
         MTerm_Action[j]        = OP_BUY;
         MTerm_Analyse[j]       = OP_HOLD;
         j++;
      }
      else
      {
         MTerm_Comments[j]      = "Fast Trix M30 is confirming  H1 down trend."; 
         MTerm_TOrientation[j]  = ORT_REVERSING;  
         MTerm_Orientation[j]   = ORT_DOWN;  
         MTerm_Action[j]        = OP_SELL;
         MTerm_Analyse[j]       = OP_EXIT_BUY;
         j++;
      }         
   }  
   if (ftrix_up  >= h1 && ftrix_down >= h4) 
   {
      if (AndS (FTRIX, S_DOWN, P_M30)) 
      {
         MTerm_Comments[j]      = "Fast Trix M30 is down while H1 and H4 are opposite.. hold your H4 sell position."; 
         MTerm_TOrientation[j]  = ORT_DOWN;  
         MTerm_Orientation[j]   = ORT_DOWN;  
         MTerm_Action[j]        = OP_SELL;
         MTerm_Analyse[j]       = OP_HOLD;
         j++;
      }
      else
      {
         MTerm_Comments[j]      = "Fast Trix M30 is confirming  H1 up trend."; 
         MTerm_TOrientation[j]  = ORT_REVERSING;  
         MTerm_Orientation[j]   = ORT_UP;  
         MTerm_Action[j]        = OP_BUY;
         MTerm_Analyse[j]       = OP_EXIT_SELL;
        j++;
      }         
   }  
   
 
   if (slope_up >= h4 && slope_down >= h1)
   {
      if (AndS (FTRIX, S_DOWN, P_M30)) 
     {
        MTerm_Comments[j]      = "Fast Trix M30 is down confirming H1 slope down trend."; 
        MTerm_Analyse[j]       = OP_EXIT_BUY;
        MTerm_Orientation[j]   = ORT_DOWN; 
        MTerm_TOrientation[j]  = ORT_REVERSING;  
        MTerm_Action[j]        = OP_SELL;
        j++; 
     }
     if (ftrix_up < ftrix_down)
     {
       if (ftrix_up < h4_h1 || ma_200_angle_m30 < 0 || slope_angle_m30 < 0 || slope_below >= h4_h1) 
       {
         MTerm_Comments[j]     = "Fast Trix is loosing momemtun. Price are below H4 H1 slope.";  
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_REVERSING;  
         MTerm_Action [j]      = OP_SELL;
         j++;
       }     
     }  
   }

   if (slope_down > h4 && slope_up > h1)           
   {
     if (AndS (FTRIX, S_UP, P_M30)) 
     {
        MTerm_Comments[j]      = "Fast Trix M30 is up confirming  H1 slope up trend.";  
        MTerm_Analyse[j]       = OP_EXIT_SELL;
        MTerm_Orientation[j]   = ORT_UP; 
        MTerm_TOrientation[j]  = ORT_REVERSING;  
        MTerm_Action[j]        = OP_BUY;
        j++;
     }
     if (ftrix_up > ftrix_down)
     {
       if (ftrix_down < h4_h1 || ma_200_angle_m30 > 0 || slope_angle_m30 > 0 || slope_above >= h4_h1) 
       {
         MTerm_Comments[j]      = "Fast Trix is gaining momemtun. Price are above H4 H1 slope.";  
         MTerm_Analyse[j]       = OP_EXIT_SELL;
         MTerm_Orientation[j]   = ORT_UP; 
         MTerm_TOrientation[j]  = ORT_REVERSING;  
         MTerm_Action[j]        = OP_BUY;
         j++;         
       }     
     }  
   }  
   
// THV EA RULE   
   for (p = P_M30; p < P_D1; p++)
   {
      if (AndS (TMA_T_S, S_BUY, p))    
      {
         MTerm_Comments[j]     = "NB 10.2 EA RULE, BUY Signal : " + PeriodName[p];        
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP; 
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Mid Term NANNING BOB BUY Signal for period " + PeriodName[p]);    
         } 
         j++;       
      }
      if (AndS (TMA_T_S, S_SELL,  p))
      {
         MTerm_Comments[j]     = "NB 10.2 EA RULE, SELL Signal : "+ PeriodName[p];        
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Mid Term NANNING BOB SELL Signal for period " + PeriodName[p]);           
         }
         j++;       
      }   

      if (AndS (TMA_S, S_BUY, p))    
      {
         MTerm_Comments[j]     = "Extreme TMA EA RULE, BUY Signal : " + PeriodName[p];        
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP; 
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected an extreme zone. We have a Mid Term Extreme T M A BUY Signal for period " + PeriodName[p]);    
         } 
         j++;       
      }
      if (AndS (TMA_S, S_SELL,  p))
      {
         MTerm_Comments[j]     = "Extreme TMA EA RULE, SELL Signal : "+ PeriodName[p];        
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected an extreme zone. We have a Mid Term Extreme T M A SELL Signal for period " + PeriodName[p]);           
         }
         j++;       
      }   
      if (AndS (TRENDLINE, S_BUY, p))    
      {
         MTerm_Comments[j]     = "SYMPHONY EA RULE, BUY Signal : " + PeriodName[p];        
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP; 
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Mid Term SYMPHONY EA RULE BUY Signal for period " + PeriodName[p]);    
         } 
         j++;       
      }
      if (AndS (TRENDLINE, S_SELL,  p))
      {
         MTerm_Comments[j]     = "SYMPHONY EA RULE, SELL Signal : "+ PeriodName[p];        
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Mid Term SYMPHONY EA RULE SELL Signal for period " + PeriodName[p]);         
         }
         j++;       
      }   
      if (AndS (FTRIX, S_BUY, p))    
      {
         MTerm_Comments[j]     = "THV EA RULE, BUY Signal : " + PeriodName[p];        
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP; 
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_EXIT_SELL;
   // Action
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Mid Term THV EA Rule BUY Signal for period " + PeriodName[p]);    
            if (AndS (FTRIX, S_ABOVE, p) && AndS (STRIX, S_ABOVE, p))      
               Send_System ("Fast Trix and Slow Trix are above average line for period " + PeriodName[p]);   
         } 
         j++;       
      }
      if (AndS (FTRIX, S_SELL,  p))
      {
         MTerm_Comments[j]     = "THV EA RULE, SELL Signal : "+ PeriodName[p];        
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
         {
            Send_System ("System has detected a Mid Term THV EA RULE SELL Signal for period " + PeriodName[p]);    
            if (AndS (FTRIX, S_BELOW, p) && AndS (STRIX, S_BELOW, p))      
               Send_System ("Fast Trix and Slow Trix are below average line for period " + PeriodName[p]);           
         }
         j++;       
      }
      if (AndS (FTRIX, S_RCROSSED,  p) && AndS (FTRIX, S_UP, p) && AndS (STRIX, S_UP, p)) 
      {
         MTerm_Comments[j]     = "BULL CROSS BUY Signal : "+ PeriodName[p];        
         MTerm_Orientation[j]  = ORT_UP; 
         MTerm_TOrientation[j] = ORT_UP; 
         MTerm_Action[j]       = OP_BUY;
         MTerm_Analyse[j]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
            Send_System ("System has detected a Mid Term Bull Cross BUY Signal for period " + PeriodName[p]);        
         j++;       
      }
      if (AndS (FTRIX, S_RCROSSED,  p) && AndS (FTRIX, S_DOWN, p) && AndS (STRIX, S_DOWN, p)) 
      {
         MTerm_Comments[j]     = "BEAR CROSS SELL Signal : "+ PeriodName[p];        
         MTerm_Orientation[j]  = ORT_DOWN; 
         MTerm_TOrientation[j] = ORT_DOWN; 
         MTerm_Action[j]       = OP_SELL;
         MTerm_Analyse[j]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))
            Send_System ("System has detected a Mid Term Bear Cross Signal for period " + PeriodName[p]);        
         j++;       
      }
    }          
   
   if (ftrix_cross_up >= m30 && ftrix_up >= h4_h1_m30 && ichi_above >= h1_m30)
   {
      MTerm_Comments[j]     = "Fast Trix for M30 or H1 or H4 are crossing up , BUY Signal";     
      MTerm_Orientation[j]  = ORT_UP; 
      MTerm_TOrientation[j] = ORT_UP; 
      MTerm_Action[j]       = OP_BUY;
      MTerm_Analyse[j]      = OP_EXIT_SELL;
      j++;       
   }
   if (ftrix_cross_down >= m30 && ftrix_down >= h4_h1_m30 && ichi_below >= h1_m30)
   {
      MTerm_Comments[j]     = "Fast Trix M30 or H1 or H4 are crossing down , SELL Signal";     
      MTerm_Orientation[j]  = ORT_DOWN; 
      MTerm_TOrientation[j] = ORT_DOWN; 
      MTerm_Action[j]       = OP_SELL;
      MTerm_Analyse[j]      = OP_EXIT_BUY;      
      j++;       
   }


   nbr_buy     = 0;
   nbr_sell    = 0;
   nbr_buysell = 0;

   MTermOrientation  = ORT_SIDEWAY;
   MTermTOrientation = ORT_SIDEWAY;               
   MTerm_Nbr = j;   
      
   for (i = 0; i < MTerm_Nbr; i++)
    if (MTerm_Action[i] == OP_BUY)     nbr_buy++;          
    else
    if (MTerm_Action[i] == OP_SELL)    nbr_sell++;
    else
    if (MTerm_Action[i] == OP_BUYSELL) nbr_buysell++;
   
    if (nbr_buy == 0 && nbr_sell > 0)
    {
       MTermOrientation = ORT_DOWN;
       MTermTOrientation = ORT_DOWN;
    }      
    else
    if (nbr_sell == 0 && nbr_buy > 0)
    {
       MTermOrientation = ORT_UP;
       MTermTOrientation = ORT_UP;
    }
    else
    if (nbr_sell > nbr_buy)
    {
       MTermOrientation = ORT_DOWN;
       MTermTOrientation = ORT_SIDEWAY;
    }
    else
    if (nbr_buy > nbr_sell)
    {
       MTermOrientation = ORT_UP;
       MTermTOrientation = ORT_SIDEWAY;
    }
   
   if (MTermLastAction != MTermAction)
   {
     MTermLastAction  = MTermAction;
     MTermTimeAction = TimeCurrent ();
   }  
   
   if (MTermLastOrientation != MTermOrientation)
   {
     if (MTermTimeOrientation > TimeCurrent () - 7200)  // 2 hours
     {
     }     
     MTermLastOrientation = MTermOrientation;
     MTermTimeOrientation = TimeCurrent ();
   }  
//STerm

   if (ma_200_angle_m5 >= 15)
   {
      STerm_Comments[k]     = "Angle is above 15 for M5 moving average 200."; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
      { 
         Send_System ("Angle is above 15 for M5 moving average 200, Orientation is SHARPLY Up");   
      }
   }

   if (ma_200_angle_m5 <= -15)
   {
      STerm_Comments[k]     = "Angle is below -15 for moving average 200."; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_SHARP; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++;       
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
      { 
         Send_System ("Angle is below -15 for M5 moving average 200, Orientation is SHARPLY Down");   
      }
   } 
   
   if (velocity_m5 >= 15)
   {
      STerm_Comments[k]     = "Velocity is above 15 for period M5"; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
      { 
         Send_System ("Velocity is above 15 for period M5, Orientation is SHARPLY Up");   
      }             
   }
      
   if (velocity_m5 <= -15)
   {
      STerm_Comments[k]     = "Velocity is below -15 for period M5";
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_SHARP; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++;   
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
      { 
         Send_System ("Velocity is below -15 for period M5, Orientation is SHARPLY Down");   
      }          
   } 
   
   if (AndS (CCI, S_OVERBOUGHT, P_M5) || AndS (CCI, S_EXT_OVERBOUGHT, P_M5))
   {   
      STerm_Comments[k]     = "CCI in Over Bought Zone for period M5."; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
      { 
         Send_System ("Commodity Channel Index is in Over Bought Zone, Orientation is SHARPLY Up");   
      }            
   }

   if (AndS (CCI, S_OVERSOLD, P_M5) || AndS (CCI, S_EXT_OVERSOLD, P_M5))
   {
      STerm_Comments[k]     = "CCI in Over Sold Zone for period M5."; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_SHARP; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++;       
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
      { 
         Send_System ("Commodity Channel Index is in Over Sold Zone, Orientation is SHARPLY Down");   
      }            
   }   


   if (res_above_s >= m15_m5_m1)
   {
      STerm_Comments[k]     = "Market crossed up M15 M5 M1 resistance."; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
   }
   if (sup_below_s >= m15_m5_m1)
   {
      STerm_Comments[k]     = "Market crossed down M15 M5 M1 support."; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_SHARP; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++;       
   }

//Rule 1   
   
   if (upfractal_above_s >= m15_m5_m1)
   {
      STerm_Comments[k]     = "Market is above M15 M5 M1 fractals."; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++;       
   }
   if (downfractal_below_s >= m15_m5_m1)
   {
      STerm_Comments[k]     = "Market is below M15 M5 M1 fractals."; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_SHARP; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++;       
   }
   if (coral_up_s >= m15_m5_m1 && coral_above_s >= m15_m5_m1)
   {
      STerm_Comments[k]     = "Coral for M15 M5 and M1 are up, price is above them."; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
   }  
   if (coral_down_s >= m15_m5_m1 && coral_below_s >= m15_m5_m1) 
   {
      STerm_Comments[k]     = "Coral for M15 M5 and M1 are down, and price is below them."; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_SHARP; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
   }
   if (coral_cross_up_s >= m15_m5) 
   {
      STerm_Comments[k]     = "Coral for M15 M5 are crossing up"; 
      STerm_Orientation[k]  = ORT_UP; 
      STerm_TOrientation[k] = ORT_REVERSING; 
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_SELL;
      k++; 
   }
   if (coral_cross_down_s >= m15_m5) 
   {
      STerm_Comments[k]     = "Coral for M15 M5 are crossing down"; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_REVERSING; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_SELL;
      k++; 
   }   
   
   if (slope_up_s >= m15_m5_m1 && slope_above_s >= m15_m5_m1)
   {
      STerm_Comments[k]     = "Slope for M15 M5 and M1 are up, price is above them."; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
   }  
   if (slope_down_s >= m15_m5_m1 && slope_below_s >= m15_m5_m1) 
   {
      STerm_Comments[k]     = "Slope for M15 M5 and M1 are down, and price is below them."; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_SHARP; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
   }
   if (slope_cross_up_s >= m15_m5) 
   {
      STerm_Comments[k]     = "Slope for M15 M5 are crossing up"; 
      STerm_Orientation[k]  = ORT_UP; 
      STerm_TOrientation[k] = ORT_REVERSING; 
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_SELL;
      k++; 
   }
   if (slope_cross_down_s >= m15_m5) 
   {
      STerm_Comments[k]     = "Slope for M15 M5 are crossing down"; 
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_REVERSING; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_SELL;
      k++; 
   }
   
   if (ichi_cross_down_s >= m15_m5)
   {
      STerm_Comments[k]      = "Ichi : Price is crossing down M15 and M5"; 
      STerm_Orientation[k]   = ORT_DOWN;  
      STerm_TOrientation[k]  = ORT_REVERSING;  
      STerm_Action[k]        = OP_SELL;
      STerm_Analyse[k]       = OP_EXIT_BUY;
      k++;
   }  
   if (ichi_below_s >= m15_m5)
   {
      STerm_Comments[k]      = "Ichi: Price is below M15 and M5"; 
      STerm_Orientation[k]   = ORT_DOWN;  
      STerm_TOrientation[k]  = ORT_DOWN;  
      STerm_Action[k]        = OP_SELL;
      STerm_Analyse[k]       = OP_EXIT_BUY;
      k++;
   }  
   if (ichi_cross_up_s >= m15_m5)
   {
      STerm_Comments[k]      = "Ichi : Price is crossing up M15 and M5"; 
      STerm_Orientation[k]   = ORT_UP;  
      STerm_TOrientation[k]  = ORT_REVERSING;  
      STerm_Action[k]        = OP_BUY;
      STerm_Analyse[k]       = OP_EXIT_SELL;
      k++;
   }  
   if (ichi_above_s >= m15_m5)
   {
      STerm_Comments[k]      = "Ichi : Price is above M15 and M5"; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_DOWN;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_EXIT_SELL;
      k++;
   }  
   
   if (ftrix_up_s >= m15_m5_m1)  
   {
      STerm_Comments[k]     = "Fast Trix for M15 M5 and M1 are all up."; 
      STerm_Orientation[k]  = ORT_UP;   
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
   }  

   if (ftrix_down_s >= m15_m5_m1) 
   {
      STerm_Comments[k]     = "Fast Trix for M15 M5 and M1 are down."; 
      STerm_Orientation[k]  = ORT_DOWN;  
      STerm_TOrientation[k] = ORT_SHARP;  
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_HOLD;
      k++; 
   }  
// Rule 2

   if (ftrix_exitbuy_s >= m1)
   {   
      STerm_Comments[k]     = "Fast Trix for M15 M5 or M1 is giving an exit buy signal";      
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_REVERSING; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_EXIT_BUY;   
      k++;       
   }
   if (ftrix_exitsell_s >= m1)
   {   
      STerm_Comments[k]     = "Fast Trix for M15 M5 or M1 is giving an exit sell signal";     
      STerm_Orientation[k]  = ORT_UP; 
      STerm_TOrientation[k] = ORT_REVERSING; 
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_EXIT_SELL;   
      k++;       
   }

   if (ftrix_up_s >= m15_m5 && strix_up_s >= m15_m5)      
   {        
      STerm_Comments[k]     = "Fast Trix and Slow Trix for M15 and M5 are up"; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_UP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_EXIT_SELL;
      k++;
   }  
   if (ftrix_down_s >= m15_m5 && strix_down_s >= m15_m5)  
   {      
      STerm_Comments[k]      = "Fast Trix and Slow Trix for M15 and M5 are down"; 
      STerm_Orientation[k]   = ORT_DOWN;  
      STerm_TOrientation[k]  = ORT_DOWN;  
      STerm_Action[k]        = OP_SELL;
      STerm_Analyse[k]       = OP_EXIT_BUY;
      k++;
   }  


   if (ma_200_angle_m5 < 0 &&
       slope_angle_m5 < 0 &&
       slope_current_m5 < ma_200_current_m5)
   {
      STerm_Comments[k]      = "M5 angle for slope and ma_200 moving average are down and slope is under ma_200"; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_UP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_EXIT_SELL;
      k++;
   }
   else
   if (ma_200_angle_m5 > 0 &&
       slope_angle_m5 > 0 &&
       slope_current_m5 > ma_200_current_m5) 
   {
      STerm_Comments[k]     = "M5 angle for slope and ma_200 moving average are up and slope is above ma_200"; 
      STerm_Orientation[k]  = ORT_UP;  
      STerm_TOrientation[k] = ORT_UP;  
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_EXIT_SELL;
      k++;
   }   

   if (ftrix_up_s  >= m15 && ftrix_down_s >= m5 ) 
   {       
      if (AndS (FTRIX, S_UP, P_M1)) 
      {
         STerm_Comments[k]      = "M1 Fast Trix is up while M5 and M15 are opposite.. hold your M15 buy position"; 
         STerm_TOrientation[k]  = ORT_UP;  
         STerm_Orientation[k]   = ORT_UP;  
         STerm_Action[k]        = OP_BUY;
         STerm_Analyse[k]       = OP_HOLD;
         k++;
      }
      else
      {
         STerm_Comments[k]      = "M1 Fast Trix is confirming  M5 down trend."; 
         STerm_TOrientation[k]  = ORT_REVERSING;  
         STerm_Orientation[k]   = ORT_DOWN;  
         STerm_Action[k]        = OP_SELL;
         STerm_Analyse[k]       = OP_EXIT_BUY;
         k++;
      }         
   }  
   if (ftrix_up_s  >= m15 && ftrix_down_s >= m5) 
   {
      if (AndS (FTRIX, S_DOWN, P_M1)) 
      {
         STerm_Comments[k]      = "M1 Fast Trix is down while M5 and M15 are opposite.. hold your H4 sell position"; 
         STerm_TOrientation[k]  = ORT_DOWN;  
         STerm_Orientation[k]   = ORT_DOWN;  
         STerm_Action[k]        = OP_SELL;
         STerm_Analyse[k]       = OP_HOLD;
         k++;
      }
      else
      {
         STerm_Comments[k]      = "M1 Fast Trix is confirming  M5 up trend."; 
         STerm_TOrientation[k]  = ORT_REVERSING;  
         STerm_Orientation[k]   = ORT_UP;  
         STerm_Action[k]        = OP_BUY;
         STerm_Analyse[k]       = OP_EXIT_SELL;
        k++;
      }         
   }  
   
 
   if (slope_up_s >= m15 && slope_down_s >= m5 && slope_below >= m5)
   {
     if (AndS (FTRIX, S_DOWN, P_M1)) 
     {
        STerm_Comments[k]      = "M1 Fast Trix is down confirming  M5 slope down trend."; 
        STerm_Action  [k]      = OP_SELL;
        STerm_Orientation[k]   = ORT_DOWN; 
        STerm_TOrientation[k]  = ORT_REVERSING;  
        STerm_Analyse[k]       = OP_EXIT_BUY;
        k++; 
     }
     if (ftrix_up_s < ftrix_down_s)
     {
       if (ftrix_up_s < m15_m5 || ma_200_angle_m5 < 0 || slope_angle_m5 < 0 || slope_below_s >= m15_m5) 
       {
         STerm_Comments[k]      = "Fast Trix is loosing momemtun. Price is below M15 M5 slope.";  
         STerm_Analyse[k]       = OP_EXIT_BUY;
         STerm_Orientation[k]   = ORT_DOWN; 
         STerm_TOrientation[k]  = ORT_REVERSING;  
         STerm_Action[k]        = OP_SELL;
         k++;
       }     
     }  
   }

   if (slope_down_s >= m15 && slope_up_s >= m5 && slope_above >= m5)          
   {
     if (AndS (FTRIX, S_UP, P_M1)) 
     {
        STerm_Comments[k]      = "M1 Fast Trix is up confirming  M5 slope up trend.";  
        STerm_Analyse[k]       = OP_EXIT_SELL;
        STerm_Orientation[k]   = ORT_UP; 
        STerm_TOrientation[k]  = ORT_REVERSING;  
        STerm_Action[k]        = OP_BUY;
        k++;
     }
     if (ftrix_up_s > ftrix_down_s)
     {
       if (ftrix_down_s < m15_m5 || ma_200_angle_m5 > 0 || slope_angle_m5 > 0 || slope_above_s >= m15_m5) 
       {
         STerm_Comments[k]      = "Fast Trix is gaining momemtun. Price is above M15 M5 slope.";  
         STerm_Action[k]        = OP_BUY;
         STerm_Orientation[k]   = ORT_UP; 
         STerm_TOrientation[k]  = ORT_REVERSING;  
         STerm_Analyse[k]       = OP_EXIT_SELL;
         k++;         
       }     
     }  
   }  
//THV MTF Rule   
   if (AndS (FTRIX, S_UP, P_M1, P_M5) && 
       (AndS (CORAL, S_CROSS_UP, P_M1) || AndS (CORAL, S_ABOVE, P_M1)) &&
       (AndS (ICHIMOKU, S_ABOVE, P_M5, P_M1) || (AndS (ICHIMOKU, S_ABOVE, P_M5) && AndS (ICHIMOKU, S_TOUCHED, P_M1)) || (AndS (ICHIMOKU, S_ABOVE, P_M1) && AndS (ICHIMOKU, S_TOUCHED, P_M5))) && 
       ((AndS (STRIX, S_UP, P_M30) && AndS (FTRIX, S_UP, P_H1, P_M30, P_M15)) ||
        (AndS (STRIX, S_UP, P_M15, P_M5)  && (AndS (FTRIX, S_UP, P_M30, P_M15)  || AndS (FTRIX, S_UP, P_H1, P_M15) || AndS (FTRIX, S_UP, P_H1, P_M30))) ||
        (AndS (STRIX, S_UP, P_M30, P_M15) && (AndS (FTRIX, S_UP, P_M30, P_M15)  || AndS (FTRIX, S_UP, P_H1, P_M15) || AndS (FTRIX, S_UP, P_H1, P_M30))) 
       )
      )  
   {
      STerm_Comments[k]     = "MTF THV RULE, BUY Signal";        
      STerm_Orientation[k]  = ORT_UP; 
      STerm_TOrientation[k] = ORT_UP; 
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_EXIT_SELL;
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))      
          Send_System ("System has detected a Short Term THV MTF BUY Signal");    
      k++;       
   }

   if (AndS (FTRIX, S_DOWN, P_M1, P_M5) && 
       (AndS (CORAL, S_CROSS_DOWN, P_M1) || AndS (CORAL, S_BELOW, P_M1)) &&
       (AndS (ICHIMOKU, S_BELOW, P_M5, P_M1) || (AndS (ICHIMOKU, S_BELOW, P_M5) && AndS (ICHIMOKU, S_TOUCHED, P_M1)) || (AndS (ICHIMOKU, S_BELOW, P_M1) && AndS (ICHIMOKU, S_TOUCHED, P_M5))) && 
       ((AndS (STRIX, S_DOWN, P_M30)       && AndS (FTRIX, S_DOWN, P_H1, P_M30, P_M15)) ||
        (AndS (STRIX, S_DOWN, P_M15, P_M5) && (AndS (FTRIX, S_DOWN, P_M30, P_M15)  || AndS (FTRIX, S_DOWN, P_H1, P_M15) || AndS (FTRIX, S_DOWN, P_H1, P_M30))) ||
        (AndS (STRIX, S_DOWN, P_M30, P_M15)&& (AndS (FTRIX, S_DOWN, P_M30, P_M15)  || AndS (FTRIX, S_DOWN, P_H1, P_M15) || AndS (FTRIX, S_DOWN, P_H1, P_M30))) 
       )
      )  
   {
      STerm_Comments[k]     = "MTF THV RULE, SELL Signal";     
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_DOWN; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_EXIT_BUY;
      if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
         Send_System ("System has detected a Short Term THV MTF SELL Signal");    
      k++;       
   }
// THV EA RULE      
   for (p = P_M1; p < P_M30; p++)
   {
      if (AndS (TMA_S, S_BUY, p))
      {
         STerm_Comments[k]     = "Extreme TMA EA RULE, BUY Signal : " + PeriodName[p];        
         STerm_Orientation[k]  = ORT_UP; 
         STerm_TOrientation[k] = ORT_UP; 
         STerm_Action[k]       = OP_BUY;
         STerm_Analyse[k]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
         { 
            Send_System ("System has detected an extreme zone. We have a T M A BUY Signal for period " + PeriodName[p]);     
         }
         k++;       
      }
      if (AndS (TMA_S, S_SELL,  p))
      {
         STerm_Comments[k]     = "Extreme TMA EA RULE, SELL Signal : "+ PeriodName[p];        
         STerm_Orientation[k]  = ORT_DOWN; 
         STerm_TOrientation[k] = ORT_DOWN; 
         STerm_Action[k]       = OP_SELL;
         STerm_Analyse[k]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))         
         { 
            Send_System ("System has detected an extreme zone. We have a T M A SELL Signal for period " + PeriodName[p]);    
         }
         k++;       
      }   
      
      if (AndS (TRENDLINE, S_BUY, p))
      {
         STerm_Comments[k]     = "SYMPHONY EA RULE, BUY Signal : " + PeriodName[p];        
         STerm_Orientation[k]  = ORT_UP; 
         STerm_TOrientation[k] = ORT_UP; 
         STerm_Action[k]       = OP_BUY;
         STerm_Analyse[k]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))        
         { 
            Send_System ("System has detected a Short Term SYMPHONY EA Rule BUY Signal for period " + PeriodName[p]);     
         }
         k++;       
      }
      if (AndS (TRENDLINE, S_SELL,  p))
      {
         STerm_Comments[k]     = "SYMPHONY EA RULE, SELL Signal : "+ PeriodName[p];        
         STerm_Orientation[k]  = ORT_DOWN; 
         STerm_TOrientation[k] = ORT_DOWN; 
         STerm_Action[k]       = OP_SELL;
         STerm_Analyse[k]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))          
         { 
            Send_System ("System has detected a Short Term SYMPHONY EA RULE SELL Signal for period " + PeriodName[p]);        
         }
         k++;       
      }   
   
   
   
      if (AndS (FTRIX, S_BUY, p))
      {
         STerm_Comments[k]     = "THV EA RULE, BUY Signal : " + PeriodName[p];        
         STerm_Orientation[k]  = ORT_UP; 
         STerm_TOrientation[k] = ORT_UP; 
         STerm_Action[k]       = OP_BUY;
         STerm_Analyse[k]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))     
         { 
            Send_System ("System has detected a Short Term THV EA Rule BUY Signal for period " + PeriodName[p]);    
            if (AndS (FTRIX, S_ABOVE, p) && AndS (STRIX, S_ABOVE, p))      
               Send_System ("Fast Trix and Slow Trix are above average line for period " + PeriodName[p]);   
         }
         k++;       
      }
      if (AndS (FTRIX, S_SELL,  p))
      {
         STerm_Comments[k]     = "THV EA RULE, SELL Signal : "+ PeriodName[p];        
         STerm_Orientation[k]  = ORT_DOWN; 
         STerm_TOrientation[k] = ORT_DOWN; 
         STerm_Action[k]       = OP_SELL;
         STerm_Analyse[k]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M5] != iTime(NULL, PeriodIndex[P_M5], 0))      
         { 
            Send_System ("System has detected a Short Term THV EA RULE SELL Signal for period " + PeriodName[p]);        
            if (AndS (FTRIX, S_BELOW, p) && AndS (STRIX, S_BELOW,p))      
               Send_System ("Fast Trix and Slow Trix are below average line for period " + PeriodName[p]);  
         }
         k++;       
      }
      if (AndS (FTRIX, S_RCROSSED,  p) && AndS (FTRIX, S_UP, p) && AndS (STRIX, S_UP, p)) 
      {
         STerm_Comments[k]     = "BULL CROSS BUY Signal : "+ PeriodName[p];        
         STerm_Orientation[k]  = ORT_UP; 
         STerm_TOrientation[k] = ORT_UP; 
         STerm_Action[k]       = OP_BUY;
         STerm_Analyse[k]      = OP_EXIT_SELL;
         if (TimeOpenBar[P_M1] != iTime(NULL, PeriodIndex[P_M1], 0))      
            Send_System ("System has detected a Short Term Bull Cross BUY Signal for period " + PeriodName[p]);        
         k++;       
      }
      if (AndS (FTRIX, S_RCROSSED,  p) && AndS (FTRIX, S_DOWN, p) && AndS (STRIX, S_DOWN, p))
      {
         STerm_Comments[k]     = "BEAR CROSS SELL Signal : "+ PeriodName[p];        
         STerm_Orientation[k]  = ORT_DOWN; 
         STerm_TOrientation[k] = ORT_DOWN; 
         STerm_Action[k]       = OP_SELL;
         STerm_Analyse[k]      = OP_EXIT_BUY;
         if (TimeOpenBar[P_M1] != iTime(NULL, PeriodIndex[P_M1], 0))      
            Send_System ("System has detected a Short Term Bear Cross Signal for period " + PeriodName[p]);        
         k++;       
      }
   }
   
   if (ftrix_cross_up_s >= m1 && ftrix_up_s >= m15_m5_m1 && ichi_above_s >= m5_m1)
   {
      STerm_Comments[k]     = "Fast Trix for M15 M5 or M1 is crossing up, BUY Signal.";     
      STerm_Orientation[k]  = ORT_UP; 
      STerm_TOrientation[k] = ORT_UP; 
      STerm_Action[k]       = OP_BUY;
      STerm_Analyse[k]      = OP_EXIT_SELL;
      k++;
   }
   if (ftrix_cross_down_s >= m1 && ftrix_down_s >= m15_m5_m1 && ichi_below_s >= m5_m1)
   {
      STerm_Comments[k]     = "Fast Trix for M15 M5 or M1 is crossing down, SELL Signal.";     
      STerm_Orientation[k]  = ORT_DOWN; 
      STerm_TOrientation[k] = ORT_DOWN; 
      STerm_Action[k]       = OP_SELL;
      STerm_Analyse[k]      = OP_EXIT_BUY;
      k++;       
   } 
   STerm_Nbr = k;     

   nbr_buy     = 0;
   nbr_sell    = 0;
   nbr_buysell = 0;

   STermOrientation  = ORT_SIDEWAY;
   STermTOrientation = ORT_SIDEWAY;               
      
   for (i = 0; i < STerm_Nbr; i++)
    if (STerm_Action[i] == OP_BUY)     nbr_buy++;          
    else
    if (STerm_Action[i] == OP_SELL)    nbr_sell++;
    else
    if (STerm_Action[i] == OP_BUYSELL) nbr_buysell++;
   
    if (nbr_buy == 0 && nbr_sell > 0)
    {
       STermOrientation  = ORT_DOWN;
       STermTOrientation = ORT_DOWN;
    }      
    else
    if (nbr_sell == 0 && nbr_buy > 0)
    {
       STermOrientation  = ORT_UP;
       STermTOrientation = ORT_UP;
    }
    else
    if (nbr_sell > nbr_buy)
    {
       STermOrientation  = ORT_DOWN;
       STermTOrientation = ORT_SIDEWAY;
    }
    else
    if (nbr_buy > nbr_sell)
    {
       STermOrientation  = ORT_UP;
       STermTOrientation = ORT_SIDEWAY;
    }
       
   if (STermLastAction != STermAction)
   {
     STermLastAction  = STermAction;
     STermTimeAction  = TimeCurrent ();
   }
          
   if (STermLastOrientation != STermOrientation)
   {
     if (STermTimeOrientation > TimeCurrent () - 7200)  // 2 hours
     {
     }     
     STermLastOrientation = STermOrientation;
     STermTimeOrientation = TimeCurrent ();
   } 
   
   
   if (Orientation == -1)
   {
     if (MTermOrientation == ORT_UP)
      Orientation = OP_BUY;
     if (MTermOrientation == ORT_DOWN)
      Orientation = OP_SELL;     
   }  
   if (Orientation == -1)
   {
     if (STermOrientation == ORT_UP)
      Orientation = OP_BUY;
     if (STermOrientation == ORT_DOWN)
      Orientation = OP_SELL;     
   }      
}
int GetSystemOrientation1 ()
{
   Orientation      = -1;
   SharpOrientation = -1;
 
            
   if (res_above         >= h4_h1_m30) {Orientation = OP_BUY;    if (res_above >= h4_h1_m30_m15) {SharpOrientation = OP_BUY;  return;}}
   if (sup_below         >= h4_h1_m30) {Orientation = OP_SELL;   if (sup_below >= h4_h1_m30_m15) {SharpOrientation = OP_SELL;  return;}}
   if (upfractal_above   >= h4_h1_m30) {Orientation = OP_BUY;    if (upfractal_above   >= h4_h1_m30_m15) {SharpOrientation = OP_BUY;  return;}}
   if (downfractal_below >= h4_h1_m30) {Orientation = OP_SELL;   if (downfractal_below >= h4_h1_m30_m15) {SharpOrientation = OP_SELL;  return;}}


//Rule 1   
   if (slope_up   >= h4_h1_m30 && slope_above >= h4_h1_m30) {Orientation = OP_BUY;  if (slope_up   >= h4_h1_m30_m15) {SharpOrientation = OP_BUY;  return;}}  
   if (slope_down >= h4_h1_m30 && slope_below >= h4_h1_m30) {Orientation = OP_SELL; if (slope_down >= h4_h1_m30_m15) {SharpOrientation = OP_SELL; return;}}
   if (coral_up   >= h4_h1_m30 && coral_above >= h4_h1_m30) {Orientation = OP_BUY;  if (coral_up   >= h4_h1_m30_m15) {SharpOrientation = OP_BUY;  return;}}  
   if (coral_down >= h4_h1_m30 && coral_below >= h4_h1_m30) {Orientation = OP_SELL; if (coral_down >= h4_h1_m30_m15) {SharpOrientation = OP_SELL; return;}}

   if (ftrix_up   >= h4_h1_m30 && ftrix_above >= h4_h1_m30) {Orientation = OP_BUY;  if (ftrix_up   >= h4_h1_m30_m15) {SharpOrientation = OP_BUY;  return;}}  
   if (ftrix_down >= h4_h1_m30 && ftrix_below >= h4_h1_m30) {Orientation = OP_SELL; if (ftrix_down >= h4_h1_m30_m15) {SharpOrientation = OP_SELL; return;}}


// Rule 2
   if (ftrix_up   >= h4_h1 && strix_up   >= h4_h1)          {Orientation = OP_BUY;   if (ftrix_above   > h4_h1_m30 && strix_above > h4_h1_m30) {SharpOrientation = OP_BUY;  return;}} 
   if (ftrix_down >= h4_h1 && strix_down >= h4_h1)          {Orientation = OP_SELL;  if (ftrix_below   > h4_h1_m30 && strix_below > h4_h1_m30) {SharpOrientation = OP_SELL;  return;}}  

  
   if (slope_up > h4 && slope_down > h1)
   {
     if (ftrix_down >= h4) {Orientation = OP_SELL;}
     if (ftrix_up < ftrix_down)
     {
       if (ftrix_up < h4_h1 || ma_200_angle_m5 < 0 || slope_angle_m5 < 0 || slope_below > h4_h1) {Orientation = OP_SELL;}     
     }  
     Orientation = OP_BUY;
   }
   else
   if (slope_down > h4 && slope_up > h1)           
   {
     if (ftrix_up >= h4) {Orientation = OP_BUY;}
     if (ftrix_up > ftrix_down)
     {
       if (ftrix_up > h4_h1 || ma_200_angle_m5 > 0|| slope_angle_m5 > 0 || slope_above > h4_h1) {Orientation = OP_BUY;}     
     }  
     Orientation = OP_SELL;
   }        

   if (AngleAbove (MA_200,  15, P_M5))  SharpOrientation = OP_BUY;          
   if (AngleBelow (MA_200, -15, P_M5))  SharpOrientation = OP_SELL;  
   
   if (velocity_m5 >= 15)               SharpOrientation = OP_BUY;     
   if (velocity_m5 <= -15)              SharpOrientation = OP_SELL;  
   
    
   if (ma_200_angle_m1 >= 10 || slope_angle_m5 >= 20)             
   {
      Orientation = OP_BUY;    
      if (divergence_m5 >= D_BuySell  && (volume_100_up - volume_100_down) >= 500)                   
         SharpOrientation = OP_BUY;  
    }
   if (ma_200_angle_m1 <= -10 || slope_angle_m5 <= -20)             
   {
      Orientation = OP_BUY;    
      if (divergence_m5 <= (-1)* D_BuySell  && (volume_100_up - volume_100_down) <= -500)                   
         SharpOrientation = OP_SELL;  
    }
   
   if (ma_200_angle_m5 < 0 &&
       slope_angle_m5 < 0 &&
       slope_current_m5 <  ma_200_current_m5)
      {Orientation = OP_SELL;}
   else
   if (ma_200_angle_m5 > 0 &&
       slope_angle_m5 > 0 &&
       slope_current_m5 >  ma_200_current_m5) 
      {Orientation = OP_BUY;}  
}
*/